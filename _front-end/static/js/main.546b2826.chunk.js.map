{"version":3,"sources":["serviceWorker.ts","redux/action-type.ts","models/user-model.ts","redux/store.ts","redux/reducer.ts","redux/app-state.ts","models/follow-model.ts","components/nav-bar/navBar.tsx","config.ts","components/home/home.tsx","services/user-validation.ts","components/registration/registration.tsx","components/login/login.tsx","components/admin/admin.tsx","services/date.ts","services/vacation-validation.ts","components/edit-vacation/editVacation.tsx","models/vacation-model.ts","components/add-vacation/addVacation.tsx","services/color.ts","components/reports/reports.tsx","components/purchase/purchase.tsx","components/purchases/purchases.tsx","components/app/app.tsx","index.tsx"],"names":["Boolean","window","location","hostname","match","ActionType","UserModel","firstName","lastName","userName","password","isAdmin","store","createStore","oldAppState","action","newAppState","type","SaveAllFollows","follows","payload","SaveAllVacations","vacations","saveOneVacation","i","vacationId","isFollow","addOneVacation","push","deleteOneVacation","filter","v","AddFollow","RemoveFollow","f","followId","PrepareVacationsForUser","counter","forEach","JSON","parse","sessionStorage","getItem","isNotFollow","concat","user","this","FollowModel","NavBar","props","state","setState","clear","className","to","exact","Button","onClick","logOut","Component","Config","serverUrl","_initialize","Home","unsubscribeStore","socket","addFollow","a","followToAdd","axios","post","emit","response","data","history","alert","removeFollow","followToRemove","find","delete","getState","io","connect","subscribe","length","get","response2","dispatch","on","vacationUpdated","vacationAdded","vacationRemoved","map","Card","key","Img","variant","src","img","Body","color","size","Title","destination","Text","description","ListGroup","ListGroupItem","Date","startingDate","toDateString","endingDate","price","validateUserName","validatePassword","Registration","setUserName","args","nameError","target","value","usersNames","error","validateAvailableUserName","errors","userNameError","setFirstName","validateFirstName","firstNameError","setLastName","validateLastName","lastNameError","setPassword","passwordError","verifyPasswordUser","verifyPassword","verifyPasswordError","isFormLegal","prop","toString","register","setItem","stringify","token","getAllUsersNames","name","id","placeholder","onChange","disabled","Login","login","e","preventDefault","onSubmit","Admin","getDataWithAjax","disconnect","JsonToString","date","d","setDate","getDate","toISOString","split","StringToJson","setHours","toJSON","validateDescription","validateDestination","validatePrice","EditVacation","setDescription","descriptionError","vacation","setDestination","destinationError","setImgUrl","imgError","setStartingDate","startingDateError","setEndingDate","endingDateError","setPrice","priceError","update","vacationToUpdate","put","params","Form","Group","controlId","Label","Control","VacationModel","AddVacation","add","addedVacation","getRandomColor","r","Math","floor","random","g","b","Reports","vacationsDestinations","vacationsFollows","colors","labels","datasets","label","backgroundColor","options","scales","yAxes","ticks","beginAtZero","userCallback","index","Purchase","setAmountOfTickets","purchase","tickets","totalPrice","send","dateNow","console","log","priceForTicket","Header","pattern","onInput","bind","Purchases","purchases","p","Table","striped","bordered","hover","App","interceptors","request","use","req","headers","authorization","res","path","render","ReactDOM","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","message"],"mappings":"+dAYoBA,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2D,IClBMC,E,mIAAAA,O,uCAAAA,I,mCAAAA,I,qDAAAA,I,qCAAAA,I,mCAAAA,I,yCAAAA,I,yBAAAA,I,gCAAAA,M,KCCL,IAAMC,EAET,WACWC,EACAC,EACAC,EACAC,EACAC,GACJ,yBALIJ,YAKL,KAJKC,WAIL,KAHKC,WAGL,KAFKC,WAEL,KADKC,WCJFC,EAAQC,aCDd,SAAgBC,EAAuBC,GAE1C,IAAMC,EAAW,eAAQF,GAEzB,OAAQC,EAAOE,MAGX,KAAKZ,EAAWa,eACZF,EAAYG,QAAUJ,EAAOK,QAC7B,MAEJ,KAAKf,EAAWgB,iBACZL,EAAYM,UAAYP,EAAOK,QAC/B,MAEJ,KAAKf,EAAWkB,gBAEZ,IAAK,IAAIC,KAAKR,EAAYM,UACtB,GAAIN,EAAYM,UAAUE,GAAGC,aAAeV,EAAOK,QAAQK,WAAY,CACnE,IAAMN,EAAQH,EAAYM,UAAUE,GAAGL,QACjCO,EAASV,EAAYM,UAAUE,GAAGE,SACxCV,EAAYM,UAAUE,GAAKT,EAAOK,QAClCJ,EAAYM,UAAUE,GAAGL,QAAQA,EACjCH,EAAYM,UAAUE,GAAGE,SAASA,EAM1C,MAEJ,KAAKrB,EAAWsB,eACZX,EAAYM,UAAUM,KAAKb,EAAOK,SAClC,MAEJ,KAAKf,EAAWwB,kBAEZb,EAAYM,UAAYN,EAAYM,UAAUQ,QAAO,SAAAC,GAAO,OAAOA,EAAEN,aAAeV,EAAOK,WAC3F,MAEJ,KAAKf,EAAW2B,UACZhB,EAAYG,QAAQS,KAAKb,EAAOK,SAChC,MAEJ,KAAKf,EAAW4B,aAEZjB,EAAYG,QAAUH,EAAYG,QAAQW,QAAO,SAAAI,GAAO,OAAOA,EAAEC,WAAapB,EAAOK,WACrF,MAEJ,KAAKf,EAAW+B,wBAEZ,IAAIC,EAAU,EACdrB,EAAYM,UAAUgB,SAAQ,SAACP,GAC3BA,EAAEL,UAAW,EACbV,EAAYG,QAAQmB,SAAQ,SAACJ,GACrBA,EAAET,aAAeM,EAAEN,aACnBY,IACIH,EAAEzB,WAAa8B,KAAKC,MAAMC,eAAeC,QAAQ,SAASjC,WAC1DsB,EAAEL,UAAW,OAIzBK,EAAEZ,QAAUkB,EACZA,EAAU,KAId,IAAMX,EAAWV,EAAYM,UAAUQ,QAAO,SAACC,GAAD,OAAsB,IAAfA,EAAEL,YACjDiB,EAAc3B,EAAYM,UAAUQ,QAAO,SAACC,GAAD,OAAsB,IAAfA,EAAEL,YAC1DV,EAAYM,UAAYI,EAASkB,OAAOD,GAOhD,OAAO3B,ID3E8B,IEMrC,aAAsB,yBAJfM,eAIc,OAHdH,aAGc,OAFd0B,UAEc,EACjBC,KAAKxB,UAAY,GACjBwB,KAAK3B,QAAQ,GACb2B,KAAKD,KAAK,IAAIvC,ICbTyC,EAET,WACWZ,EACA1B,EACAgB,GAAsB,yBAFtBU,WAEqB,KADrB1B,WACqB,KAArBgB,c,mECMFuB,EAAb,kDAEI,WAAmBC,GAAa,IAAD,8BAC3B,cAAMA,IAEDC,MAAQ,CACTL,KAAM,IAAIvC,GAJa,EAFnC,gEAWQ,GAAImC,eAAeC,QAAQ,QAAS,CAChC,IAAMG,EAAON,KAAKC,MAAMC,eAAeC,QAAQ,SAC/CI,KAAKK,SAAS,CAAEN,YAb5B,+BAmBQJ,eAAeW,UAnBvB,+BAuBQ,OACI,yBAAKC,UAAU,WACX,yBAAKA,UAAU,iBACX,6BACKP,KAAKI,MAAML,KAAKlC,QACb,4BACI,4BACI,kBAAC,IAAD,CAAS2C,GAAG,IAAIC,OAAK,GAArB,SAEJ,4BACI,kBAAC,IAAD,CAASD,GAAG,SAASC,OAAK,GAA1B,oBAEJ,4BACI,kBAAC,IAAD,CAASD,GAAG,aAAaC,OAAK,GAA9B,kBAEJ,4BACI,kBAAC,IAAD,CAASD,GAAG,aAAaC,OAAK,GAA9B,eAEJ,4BACI,kBAAC,IAAD,CAASD,GAAG,WAAWC,OAAK,GAA5B,eAIR,4BACI,4BACI,kBAAC,IAAD,CAASD,GAAG,IAAIC,OAAK,GAArB,UAKZ,yBAAKF,UAAU,QACX,uCAAaP,KAAKI,MAAML,KAAKpC,SAA7B,KAEA,6BACI,kBAAC,IAAD,CAAS6C,GAAG,SAASC,OAAK,GACtB,kBAACC,EAAA,EAAD,CAAQC,QAASX,KAAKY,QAAtB,gBASpB,yBAAKL,UAAU,eAnE/B,GAA4BM,aCXfC,EAAb,2GAMYA,EAAOC,UAAU,2CAN7B,KAAaD,EAEKC,e,EAelBD,EAAOE,cCOA,IAAMC,EAAb,kDAKI,WAAmBd,GAAa,IAAD,8BAC3B,cAAMA,IAJFe,sBAGuB,IAFvBC,YAEuB,IAoFvBC,UApFuB,uCAoFX,WAAOzC,GAAP,iBAAA0C,EAAA,6DACVC,EAAc,IAAIrB,GACZtC,SAAW8B,KAAKC,MAAMC,eAAeC,QAAQ,SAASjC,SAClE2D,EAAY3C,WAAaA,EAHT,kBAKN4C,IAAMC,KAAkBV,EAAOC,UAAU,eAAgBO,GALnD,OAMZ,EAAKH,OAAOM,KAAK,qCANL,mDAU+B,oCAAvC,eAAoBC,gBAApB,eAA8BC,MAVtB,wBAWRhC,eAAeW,QACf,EAAKH,MAAMyB,QAAQ9C,KAAK,UAZhB,2BAiBR+C,MAAM,EAAD,IAjBG,yDApFW,wDA2GvBC,aA3GuB,uCA2GR,WAAOnD,GAAP,mBAAA0C,EAAA,6DAEb1D,EAAW8B,KAAKC,MAAMC,eAAeC,QAAQ,SAASjC,SAEtDoE,EAAiB,EAAK3B,MAAM/B,QAAQ2D,MAAK,SAAA5C,GAC3C,OAAOA,EAAEzB,WAAaA,GAAYyB,EAAET,aAAeA,KALpC,kBAST4C,IAAMU,OAAN,UAAgBnB,EAAOC,UAAvB,wBAAgDgB,EAAe1C,WATtD,OAUf,EAAK8B,OAAOM,KAAK,qCAVF,mDAc4B,oCAAvC,eAAoBC,gBAApB,eAA8BC,MAdnB,wBAeXhC,eAAeW,QACf,EAAKH,MAAMyB,QAAQ9C,KAAK,UAhBb,2BAqBX+C,MAAM,EAAD,IArBM,yDA3GQ,sDAI3B,EAAKzB,MAAQ,CACT5B,UAAWV,EAAMoE,WAAW1D,UAC5BH,QAASP,EAAMoE,WAAW7D,SANH,EALnC,kMAqBasB,eAAeC,QAAQ,UAAaD,eAAeC,QAAQ,QArBxE,uBAsBYI,KAAKG,MAAMyB,QAAQ9C,KAAK,UAtBpC,6BA2BSkB,KAAKmB,OAASgB,IAAGC,QAAQtB,EAAOC,WAGjCf,KAAKkB,iBAAmBpD,EAAMuE,WAAU,WACpC,IAAM7D,EAAYV,EAAMoE,WAAW1D,UAC7BH,EAAUP,EAAMoE,WAAW7D,QACjC,EAAKgC,SAAS,CAAE7B,YAAWH,eAIzBP,EAAMoE,WAAW7D,QAAQiE,OAAS,GAAKxE,EAAMoE,WAAW1D,UAAU8D,OAAS,EArCzF,0CAyCoBf,IAAMgB,IAAqBzB,EAAOC,UAAU,kBAzChE,cAwCsBW,EAxCtB,OA0CsBlD,EAAYkD,EAASC,KA1C3C,UA6CoBJ,IAAMgB,IAAmBzB,EAAOC,UAAU,gBA7C9D,QA4CsByB,EA5CtB,OA8CsBnE,EAAUmE,EAAUb,KAE1B7D,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWa,eAAgBE,QAASD,IAC3DP,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWgB,iBAAkBD,QAASE,IAC7DV,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAW+B,0BAlDlD,qDAsD2D,oCAAvC,eAAoBoC,gBAApB,eAA8BC,MAtDlD,wBAuDoBhC,eAAeW,QACfN,KAAKG,MAAMyB,QAAQ9C,KAAK,UAxD5C,2BA6DoB+C,MAAM,EAAD,IA7DzB,QAmEQ7B,KAAKmB,OAAOuB,GAAG,wCAAwC,SAAAC,GACnD7E,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWkB,gBAAiBH,QAASqE,OAEhE3C,KAAKmB,OAAOuB,GAAG,8BAA8B,SAAAE,GACzC9E,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWsB,eAAgBP,QAASsE,OAE/D5C,KAAKmB,OAAOuB,GAAG,gCAAgC,SAAAG,GAC3C/E,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWwB,kBAAmBT,QAASuE,OAElE7C,KAAKmB,OAAOuB,GAAG,8BAAf,sBAA8C,8BAAArB,EAAA,sEAEtCE,IAAMgB,IAAmBzB,EAAOC,UAAU,gBAFJ,OACpCyB,EADoC,OAGpCnE,EAAUmE,EAAUb,KAC1B7D,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWa,eAAgBE,QAASD,IAC3DP,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAW+B,0BALQ,4CA5EtD,+LAmJqB,IAAD,OAEZ,OACI,yBAAKiB,UAAU,QACX,kBAAC,EAAD,MACA,yBAAKA,UAAU,kBACVP,KAAKI,MAAM5B,UAAUsE,KAAI,SAAA7D,GAAC,OAGvB,kBAAC8D,EAAA,EAAD,CAAQC,IAAK/D,EAAEN,YACX,kBAACoE,EAAA,EAAKE,IAAN,CAAUC,QAAQ,MAAM3C,UAAU,MAAM4C,IAAK,4BAA8BlE,EAAEmE,MAC7E,kBAACL,EAAA,EAAKM,KAAN,KACKpE,EAAEL,SAAW,kBAAC,IAAD,CAAU2B,UAAU,YAAY+C,MAAM,SAASC,KAAM,SAAU5C,QAAS,kBAAM,EAAKmB,aAAa7C,EAAEN,eAAkB,kBAAC,IAAD,CAAU4B,UAAU,YAAY+C,MAAM,OAAOC,KAAM,SAAU5C,QAAS,kBAAM,EAAKS,UAAUnC,EAAEN,eAE/N,kBAACoE,EAAA,EAAKS,MAAN,KAAavE,EAAEwE,aACf,kBAACV,EAAA,EAAKW,KAAN,KACKzE,EAAE0E,cAGX,kBAACC,EAAA,EAAD,CAAWrD,UAAU,oBACjB,kBAACsD,EAAA,EAAD,iBAAyB5E,EAAEZ,SAC3B,kBAACwF,EAAA,EAAD,eAAuB,IAAIC,KAAK7E,EAAE8E,cAAcC,gBAChD,kBAACH,EAAA,EAAD,aAAqB,IAAIC,KAAK7E,EAAEgF,YAAYD,gBAC5C,kBAACH,EAAA,EAAD,cAAsB5E,EAAEiF,MAAxB,KACA,kBAACL,EAAA,EAAD,KAAe,kBAAC,IAAD,CAAStD,UAAU,WAAWC,GAAI,aAAavB,EAAEN,WAAY8B,OAAK,GAAlE,0BA3K/C,GAA0BI,a,OCdnB,SAASsD,EAAiBxG,GAE7B,MAAiB,KAAbA,EACO,oBAGHA,EAAS2E,OAAS,EACf,sBAGF3E,EAAS2E,OAAS,GAChB,qBAEJ,GA+CJ,SAAS8B,EAAiBxG,GAC7B,MAAiB,KAAbA,EACO,mBAGHA,EAAS0E,OAAS,EACf,wBAGF1E,EAAS0E,OAAS,GAChB,uBAEJ,GCpDJ,IAAM+B,EAAb,kDAEI,WAAmBlE,GAAa,IAAD,8BAC3B,cAAMA,IAQFmE,YAAc,SAACC,GACnB,IAEIC,EAFE7G,EAAW4G,EAAKE,OAAOC,MAKX,gCADlBF,ED9CD,SAAmC7G,EAASgH,GAC/C,IAAIC,EAAM,GAMV,OALAD,EAAWnF,SAAQ,SAAAO,GACZpC,IAAWoC,EAAKpC,WACfiH,EAAM,iCAGPA,ECuCSC,CAA0BlH,EAAU,EAAKyC,MAAMuE,eAEvDH,EAAYL,EAAiBxG,IAGjC,IAAMmH,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOC,cAAgBP,EACvB,EAAKnE,SAAS,CAAEyE,WAEhB,IAAM/E,EAAI,eAAQ,EAAKK,MAAML,MAC7BA,EAAKpC,SAAWA,EAChB,EAAK0C,SAAS,CAAEN,UAzBW,EA4BvBiF,aAAe,SAACT,GACpB,IAAM9G,EAAY8G,EAAKE,OAAOC,MAE1BF,EDpCL,SAA2B/G,GAC9B,MAAkB,KAAdA,EACO,qBAGHA,EAAU6E,OAAS,EACf,0BAGH7E,EAAU6E,OAAS,GAChB,yBAGF,KAAK7E,EAAU,IAAMA,EAAU,IAAK,IAIvC,GAHK,8CCsBQwH,CAAkBxH,GAE5BqH,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOI,eAAiBV,EACxB,EAAKnE,SAAS,CAAEyE,WAEhB,IAAM/E,EAAI,eAAQ,EAAKK,MAAML,MAC7BA,EAAKtC,UAAYA,EACjB,EAAK4C,SAAS,CAAEN,UAvCW,EA2CvBoF,YAAc,SAACZ,GACnB,IAAM7G,EAAW6G,EAAKE,OAAOC,MAEzBF,ED9BL,SAA0B9G,GAC7B,MAAiB,KAAbA,EACQ,oBAGJA,EAAS4E,OAAS,EACd,yBAGH5E,EAAS4E,OAAS,GACf,wBAGF,KAAK5E,EAAS,IAAMA,EAAS,IAAK,IAIrC,GAHK,8CCgBQ0H,CAAiB1H,GAE3BoH,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOO,cAAgBb,EACvB,EAAKnE,SAAS,CAAEyE,WAEhB,IAAM/E,EAAI,eAAQ,EAAKK,MAAML,MAC7BA,EAAKrC,SAAWA,EAChB,EAAK2C,SAAS,CAAEN,UAtDW,EA0DvBuF,YAAc,SAACf,GACnB,IAAM3G,EAAW2G,EAAKE,OAAOC,MAEzBF,EAAYJ,EAAiBxG,GAE3BkH,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOS,cAAgBf,EACvB,EAAKnE,SAAS,CAAEyE,WAEhB,IAAM/E,EAAI,eAAQ,EAAKK,MAAML,MAC7BA,EAAKnC,SAAWA,EAChB,EAAKyC,SAAS,CAAEN,UArEW,EAyEvByF,mBAAqB,SAACjB,GAC1B,IAGIC,EDxBL,SAAwBiB,EAAe7H,GAC1C,MAAoB,KAAjB6H,EACQ,4BAEFA,IAAmB7H,EACjB,kBAEJ,GCiBa6H,CAHSlB,EAAKE,OAAOC,MAC3B,eAAQ,EAAKtE,MAAML,MAEyBnC,UAEhDkH,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOY,oBAAsBlB,EAC7B,EAAKnE,SAAS,CAAEyE,YAjFW,EAoFvBa,YAAc,WAClB,IAAK,IAAMC,KAAQ,EAAKxF,MAAM0E,OAC1B,GAA2C,KAAvC,EAAK1E,MAAM0E,OAAOc,GAAMC,WACxB,OAAO,EAGf,OAAO,GA1FoB,EA6FvBC,SA7FuB,sBA6FZ,4BAAAzE,EAAA,+EAGYE,IAAMC,KAAKV,EAAOC,UAAY,qBACjD,EAAKX,MAAML,MAJJ,OAGL2B,EAHK,OAMX/B,eAAeoG,QAAQ,OAAQtG,KAAKuG,UAAUtE,EAASC,KAAK5B,OAC5DJ,eAAeoG,QAAQ,QAASrE,EAASC,KAAKsE,OAE9C,EAAK9F,MAAMyB,QAAQ9C,KAAK,KATb,gDAaX+C,MAAM,EAAD,IAbM,yDA3Ff,EAAKzB,MAAQ,CACTL,KAAM,IAAIvC,EACVmH,WAAY,GACZG,OAAQ,CAAEC,cAAe,IAAKG,eAAgB,IAAKG,cAAe,IAAKE,cAAe,IAAKG,oBAAqB,MALzF,EAFnC,0MAmHmCnE,IAAMgB,IAAiBzB,EAAOC,UAAY,wBAnH7E,OAmHkBW,EAnHlB,OAoHkBiD,EAAajD,EAASC,KAE5B3B,KAAKK,SAAS,CAAEsE,eAtH5B,gDA0HY9C,MAAM,EAAD,IA1HjB,yJAiIYlC,eAAeC,QAAQ,SACvBI,KAAKG,MAAMyB,QAAQ9C,KAAK,KAI5BkB,KAAKkG,qBAtIb,+BA0IQ,OACI,yBAAK3F,UAAU,gBACX,yBAAKA,UAAU,qBACX,uCACA,0BAAMtC,OAAO,IACT,yBAAKsC,UAAU,aACX,2BAAOpC,KAAK,OAAOgI,KAAK,GAAGC,GAAG,UAAUC,YAAY,YAAYC,SAAUtG,KAAKsE,cAC/E,0BAAM/D,UAAU,SAA4C,KAAnCP,KAAKI,MAAM0E,OAAOC,cAAuB,GAAK/E,KAAKI,MAAM0E,OAAOC,gBAE7F,yBAAKxE,UAAU,aACX,2BAAOpC,KAAK,OAAOgI,KAAK,GAAGC,GAAG,UAAUC,YAAY,aAAaC,SAAUtG,KAAKgF,eAChF,0BAAMzE,UAAU,SAA6C,KAApCP,KAAKI,MAAM0E,OAAOI,eAAwB,GAAKlF,KAAKI,MAAM0E,OAAOI,iBAE9F,yBAAK3E,UAAU,aACX,2BAAOpC,KAAK,OAAOgI,KAAK,GAAGC,GAAG,UAAUC,YAAY,YAAYC,SAAUtG,KAAKmF,cAC/E,0BAAM5E,UAAU,SAA4C,KAAnCP,KAAKI,MAAM0E,OAAOO,cAAuB,GAAKrF,KAAKI,MAAM0E,OAAOO,gBAE7F,yBAAK9E,UAAU,aACX,2BAAOpC,KAAK,WAAWgI,KAAK,GAAGC,GAAG,UAAUC,YAAY,WAAWC,SAAUtG,KAAKsF,cAClF,0BAAM/E,UAAU,SAA4C,KAAnCP,KAAKI,MAAM0E,OAAOS,cAAuB,GAAKvF,KAAKI,MAAM0E,OAAOS,gBAE7F,yBAAKhF,UAAU,aACX,2BAAOpC,KAAK,WAAWgI,KAAK,GAAGC,GAAG,UAAUC,YAAY,kBAAkBC,SAAUtG,KAAKwF,qBACzF,0BAAMjF,UAAU,SAAkD,KAAzCP,KAAKI,MAAM0E,OAAOY,oBAA6B,GAAK1F,KAAKI,MAAM0E,OAAOY,sBAEnG,kBAAChF,EAAA,EAAD,CAAQwC,QAAQ,UAAU/E,KAAK,SAASoI,UAAWvG,KAAK2F,cAAehF,QAASX,KAAK8F,UAArF,YAGJ,kBAAC,IAAD,CAASvF,UAAU,WAAWC,GAAG,SAASC,OAAK,GAA/C,2BAAwE,6BAAxE,sBAtKpB,GAAkCI,aCXrB2F,G,OAAb,kDAEI,WAAmBrG,GAAa,IAAD,8BAC3B,cAAMA,IAQFmE,YAAc,SAACC,GACnB,IAAM5G,EAAW4G,EAAKE,OAAOC,MAEzBF,EAAYL,EAAiBxG,GAE3BmH,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOC,cAAgBP,EACvB,EAAKnE,SAAS,CAAEyE,WAEhB,IAAM/E,EAAI,eAAQ,EAAKK,MAAML,MAC7BA,EAAKpC,SAAWA,EAChB,EAAK0C,SAAS,CAAEN,UApBW,EAwBvBuF,YAAc,SAACf,GACnB,IAAM3G,EAAW2G,EAAKE,OAAOC,MAEzBF,EAAYJ,EAAiBxG,GAE3BkH,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOS,cAAgBf,EACvB,EAAKnE,SAAS,CAAEyE,WAEhB,IAAM/E,EAAI,eAAQ,EAAKK,MAAML,MAC7BA,EAAKnC,SAAWA,EAChB,EAAKyC,SAAS,CAAEN,UAnCW,EAsCvB0G,MAtCuB,uCAsCf,WAAOC,GAAP,mBAAArF,EAAA,sEAGRqF,EAAEC,iBAHM,SAIepF,IAAMC,KAAKV,EAAOC,UAAY,kBACjD,EAAKX,MAAML,MALP,OAIF2B,EAJE,OAOR/B,eAAeoG,QAAQ,OAAQtG,KAAKuG,UAAUtE,EAASC,KAAK5B,OAC5DJ,eAAeoG,QAAQ,QAASrE,EAASC,KAAKsE,OAE9C,EAAK9F,MAAMyB,QAAQ9C,KAAK,KAVhB,qDAcmC,kCAAvC,eAAoB4C,gBAApB,eAA8BC,MAd1B,wBAeJE,MAAK,QAAE,EAAD,KAAoBH,gBAArB,aAAC,EAA8BC,MAfhC,2BAoBJE,MAAM,EAAD,IApBD,0DAtCe,wDAkEvB8D,YAAc,WAClB,IAAK,IAAMC,KAAQ,EAAKxF,MAAM0E,OAC1B,GAA2C,KAAvC,EAAK1E,MAAM0E,OAAOc,GAAMC,WACxB,OAAO,EAGf,OAAO,GAtEP,EAAKzF,MAAQ,CACTL,KAAM,IAAIvC,EACVsH,OAAQ,CAAEC,cAAe,IAAKQ,cAAe,MAJtB,EAFnC,gEAgFY5F,eAAeC,QAAQ,UAAYH,KAAKC,MAAMC,eAAeC,QAAQ,UACrEI,KAAKG,MAAMyB,QAAQ9C,KAAK,OAjFpC,+BAuFQ,OACI,yBAAKyB,UAAU,SACX,yBAAKA,UAAU,cACX,0BAAMA,UAAU,aAAaqG,SAAU5G,KAAKyG,OACxC,qCACA,2BAAOtI,KAAK,OAAOgI,KAAK,GAAGC,GAAG,UAAUC,YAAY,YAAYC,SAAUtG,KAAKsE,cAC/E,2BAAOnG,KAAK,WAAWgI,KAAK,GAAGC,GAAG,UAAUC,YAAY,WAAWC,SAAUtG,KAAKsF,cAClF,6BAEA,kBAAC5E,EAAA,EAAD,CAAQwC,QAAQ,UAAU/E,KAAK,SAASoI,UAAWvG,KAAK2F,eAAxD,UAIJ,kBAAC,IAAD,CAASpF,UAAU,WAAWC,GAAG,gBAAgBC,OAAK,GAAtD,mCApGpB,GAA2BI,c,2BCIdgG,EAAb,kDAKI,WAAmB1G,GAAa,IAAD,8BAC3B,cAAMA,IAJFe,sBAGuB,IAFvBC,YAEuB,IA6DvB2F,gBA7DuB,sBA6DN,kCAAAzF,EAAA,+EAGbE,IAAMgB,IAAqBzB,EAAOC,UAAU,kBAH/B,OAEXW,EAFW,OAIXlD,EAAYkD,EAASC,KAC3B7D,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWgB,iBAAkBD,QAASE,IAL5C,mDAS0B,oCAAvC,eAAoBkD,gBAApB,eAA8BC,MATjB,wBAUbhC,eAAeW,QACfuB,MAAK,QAAE,EAAD,KAAoBH,gBAArB,aAAC,EAA8BC,MACpC,EAAKxB,MAAMyB,QAAQ9C,KAAK,UAZX,2BAiBb+C,MAAM,EAAD,IAjBQ,yDAzDrB,EAAKzB,MAAQ,CACT5B,UAAWV,EAAMoE,WAAW1D,WALL,EALnC,wLAiBamB,eAAeC,QAAQ,UAAaD,eAAeC,QAAQ,QAjBxE,uBAkBYI,KAAKG,MAAMyB,QAAQ9C,KAAK,UAlBpC,0BAuBkBW,KAAKC,MAAMC,eAAeC,QAAQ,SAAS/B,SACjDmC,KAAKG,MAAMyB,QAAQ9C,KAAK,KAxBpC,UA4BSkB,KAAKmB,OAASgB,IAAGC,QAAQtB,EAAOC,WAGjCf,KAAKkB,iBAAmBpD,EAAMuE,WAAU,WACpC,IAAM7D,EAAYV,EAAMoE,WAAW1D,UACnC,EAAK6B,SAAS,CAAE7B,mBAKhBwB,KAAKI,MAAM5B,UAAU8D,OAAS,GAtC1C,mDA2CQtC,KAAK8G,kBAGL9G,KAAKmB,OAAOuB,GAAG,wCAAwC,SAAAC,GACnD7E,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWkB,gBAAiBH,QAASqE,OAEhE3C,KAAKmB,OAAOuB,GAAG,8BAA8B,SAAAE,GACzC9E,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWsB,eAAgBP,QAASsE,OAE/D5C,KAAKmB,OAAOuB,GAAG,gCAAgC,SAAAG,GAC3C/E,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWwB,kBAAmBT,QAASuE,OArD1E,oJA6DQ7C,KAAKkB,mBACLlB,KAAKmB,OAAO4F,eA9DpB,sEA0FyBpI,GA1FzB,kGA4FkB4C,IAAMU,OAAN,UAAgBnB,EAAOC,UAAvB,0BAAkDpC,IA5FpE,OA6FYb,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWwB,kBAAmBT,QAASK,IAC9DqB,KAAKmB,OAAOM,KAAK,uCAAwC9C,GA9FrE,mDAkGuD,oCAAvC,eAAoB+C,gBAApB,eAA8BC,MAlG9C,wBAmGgBhC,eAAeW,QACfuB,MAAK,QAAE,EAAD,KAAoBH,gBAArB,aAAC,EAA8BC,MACpC3B,KAAKG,MAAMyB,QAAQ9C,KAAK,UArGxC,2BA0GgB+C,MAAM,EAAD,IA1GrB,+IA+GqB,IAAD,OACZ,OACI,yBAAKtB,UAAU,QACX,kBAAC,EAAD,MACA,yBAAKA,UAAU,kBACdP,KAAKI,MAAM5B,UAAUsE,KAAI,SAAA7D,GAAC,OAEvB,kBAAC8D,EAAA,EAAD,CAAMC,IAAK/D,EAAEN,YACT,kBAACoE,EAAA,EAAKE,IAAN,CAAUC,QAAQ,MAAM3C,UAAU,MAAM4C,IAAK,4BAA4BlE,EAAEmE,MAC3E,kBAACL,EAAA,EAAKM,KAAN,KACI,kBAAC,IAAD,CAAG9C,UAAU,SAAS+C,MAAM,QAAQC,KAAM,SAAU5C,QAAS,kBAAM,EAAKsB,OAAOhD,EAAEN,eACjF,kBAAC,IAAD,CAAS6B,GAAI,UAAYvB,EAAEN,YACvB,kBAAC,IAAD,CAAQ2E,MAAM,QAAQC,KAAM,YAEhC,kBAACR,EAAA,EAAKS,MAAN,KAAavE,EAAEwE,aACf,kBAACV,EAAA,EAAKW,KAAN,KACKzE,EAAE0E,cAIX,kBAACC,EAAA,EAAD,CAAWrD,UAAU,oBACjB,kBAACsD,EAAA,EAAD,eAAuB,IAAIC,KAAK7E,EAAE8E,cAAcC,gBAChD,kBAACH,EAAA,EAAD,aAAqB,IAAIC,KAAK7E,EAAEgF,YAAYD,gBAC5C,kBAACH,EAAA,EAAD,cAAsB5E,EAAEiF,MAAxB,WAKZ,kCA3IhB,GAA2BrD,a,eCvBpB,SAASmG,EAAaC,GACzB,IAAMC,EAAE,IAAIpD,KAAKmD,GAIlB,OAHCC,EAAEC,QAAQD,EAAEE,UAAU,GACLF,EAAEG,cACEC,MAAM,KACjB,GAIP,SAASC,EAAaN,GACzB,IAAMC,EAAE,IAAIpD,KAAKmD,GAIjB,OAHAC,EAAEC,QAAQD,EAAEE,UAAU,GACtBF,EAAEM,SAAS,IACMN,EAAEO,SCZhB,SAASC,EAAoB/D,GAEhC,MAAoB,KAAhBA,EACO,sBAGHA,EAAYrB,OAAS,EAClB,2BAGFqB,EAAYrB,OAAS,IACnB,0BAEJ,GAIJ,SAASqF,EAAoBlE,GAChC,MAAoB,KAAhBA,EACO,sBAGHA,EAAYnB,OAAS,EACjB,2BAGHmB,EAAYnB,OAAS,GAClB,0BAGF,KAAKmB,EAAY,IAAMA,EAAY,IAAK,IAG3C,GAFK,+CAqBT,SAASmE,EAAc1D,GAE1B,OAAKA,EAIGA,EAAQ,EACL,0BAGFA,EAAQ,IACN,oBAEJ,GAVI,gB,WC3BF2D,EAAb,kDAKI,WAAmB1H,GAAa,IAAD,8BAC3B,cAAMA,IAJFe,sBAGuB,IAFvBC,YAEuB,IA+FxB2G,eAAiB,SAACvD,GACrB,IACIC,EADEb,EAAcY,EAAKE,OAAOC,MAGhCF,EAAYkD,EAAoB/D,GAEhC,IAAMmB,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOiD,iBAAmBvD,EAC1B,EAAKnE,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UACjCA,EAASrE,YAAcA,EACvB,EAAKtD,SAAS,CAAE2H,cA3GW,EA6GxBC,eAAiB,SAAC1D,GACrB,IACIC,EADEf,EAAcc,EAAKE,OAAOC,MAGhCF,EAAYmD,EAAoBlE,GAEhC,IAAMqB,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOoD,iBAAmB1D,EAC1B,EAAKnE,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UACjCA,EAASvE,YAAcA,EACvB,EAAKpD,SAAS,CAAE2H,cAzHW,EA4HxBG,UAAY,SAAC5D,GAChB,IAAMnB,EAAMmB,EAAKE,OAAOC,MAKxB,IAAMI,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOsD,SD9HJ,GC+HH,EAAK/H,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UACjCA,EAAS5E,IAAMA,EACf,EAAK/C,SAAS,CAAE2H,cAxIW,EA0IxBK,gBAAkB,SAAC9D,GACtB,IAAMR,EAAeQ,EAAKE,OAAOC,MAKjC,IAAMI,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOwD,kBDxIJ,GCyIH,EAAKjI,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UAEjCA,EAASjE,aAAeA,EACxB,EAAK1D,SAAS,CAAE2H,cAvJW,EAyJxBO,cAAgB,SAAChE,GACpB,IAAMN,EAAaM,EAAKE,OAAOC,MAK/B,IAAMI,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAO0D,gBDnJJ,GCoJH,EAAKnI,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UAEjCA,EAAS/D,WAAaA,EACtB,EAAK5D,SAAS,CAAE2H,cAtKW,EAyKvBS,SAAW,SAAClE,GAChB,IACIC,EADEN,GAASK,EAAKE,OAAOC,MAG3BF,EAAYoD,EAAc1D,GAE1B,IAAMY,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAO4D,WAAalE,EACpB,EAAKnE,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UACjCA,EAAS9D,MAAQA,EACjB,EAAK7D,SAAS,CAAE2H,cArLW,EAiMxBW,OAjMwB,sBAiMf,kCAAAtH,EAAA,sEAEFuH,EAFE,eAEsB,EAAKxI,MAAM4H,UAFjC,SAGFzG,IAAMsH,IAAN,UAAa/H,EAAOC,UAApB,2BAAgD,EAAKZ,MAAM7C,MAAMwL,OAAO1C,IAC1EwC,GAJI,OAKRA,EAAiB7E,aAAewD,EAAaqB,EAAiB7E,cAC9D6E,EAAiB3E,WAAasD,EAAaqB,EAAiB3E,YAC5DnG,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWkB,gBAAiBH,QAASsK,IAC5D,EAAKzH,OAAOM,KAAK,uCAAwCmH,GACzD,EAAKzI,MAAMyB,QAAQ9C,KAAK,UAThB,qDAamC,oCAAvC,eAAoB4C,gBAApB,eAA8BC,MAb1B,wBAcJhC,eAAeW,QACfuB,MAAK,QAAE,EAAD,KAAoBH,gBAArB,aAAC,EAA8BC,MACpC,EAAKxB,MAAMyB,QAAQ9C,KAAK,UAhBpB,8BAoBwC,wBAAvC,eAAoB4C,gBAApB,eAA8BC,MApB/B,wBAqBJ,EAAKxB,MAAMyB,QAAQ9C,KAAK,UArBpB,2BA0BJ+C,MAAM,EAAD,IA1BD,0DA7LZ,EAAKzB,MAAQ,CACT5B,UAAWV,EAAMoE,WAAW1D,UAC5BwJ,SAAU,GACVlD,OAAQ,CAAEiD,iBAAkB,GAAIG,iBAAkB,GAAIE,SAAU,GAAIE,kBAAmB,GAAIE,gBAAiB,GAAIE,WAAY,KAPrG,EALnC,sMAuBS1I,KAAKmB,OAASgB,IAAGC,QAAQtB,EAAOC,WAIjCf,KAAKkB,iBAAmBpD,EAAMuE,WAAU,WACpC,IAAM7D,EAAYV,EAAMoE,WAAW1D,UACnC,EAAK6B,SAAS,CAAE7B,iBAIfmB,eAAeC,QAAQ,UAAaD,eAAeC,QAAQ,QAjCxE,uBAkCYI,KAAKG,MAAMyB,QAAQ9C,KAAK,UAlCpC,0BAuCkBW,KAAKC,MAAMC,eAAeC,QAAQ,SAAS/B,SACjDmC,KAAKG,MAAMyB,QAAQ9C,KAAK,KAxCpC,YAgDYkB,KAAKI,MAAM5B,UAAU8D,OAAS,GAhD1C,+BAkD0BtC,KAAKI,MAAM5B,WAlDrC,IAkDY,4BAASS,EAA2B,SAC1BN,cAAgBqB,KAAKG,MAAM7C,MAAMwL,OAAO1C,KAC1C4B,EAAQ,eAAS/I,IApDrC,WAAAyH,EAAA,oEA8DoBnF,IAAMgB,IAAN,UAA4BzB,EAAOC,UAAnC,2BAA+Df,KAAKG,MAAM7C,MAAMwL,OAAO1C,KA9D3G,QA6DsB1E,EA7DtB,OA+DgBsG,EAAWtG,EAASC,KA/DpC,sDAqE2D,oCAAvC,eAAoBD,gBAApB,eAA8BC,MArElD,wBAsEoBhC,eAAeW,QACfuB,MAAM,EAAD,IAvEzB,2BA6EoBA,MAAK,QAAE,EAAD,KAAoBH,gBAArB,aAAC,EAA8BC,MA7ExD,QAuFQqG,EAASjE,aAAeiD,EAAagB,EAASjE,cAC9CiE,EAAS/D,WAAa+C,EAAagB,EAAS/D,YAC5CjE,KAAKK,SAAS,CAAE2H,aAzFxB,8JA+FQhI,KAAKkB,mBACLlB,KAAKmB,OAAO4F,eAhGpB,oCA8LQ,IAAK,IAAMnB,KAAQ5F,KAAKI,MAAM0E,OAC1B,GAA2C,KAAvC9E,KAAKI,MAAM0E,OAAOc,GAAMC,WACxB,OAAO,EAGf,OAAO,IAnMf,+BAuOQ,OACI,yBAAKtF,UAAU,gBACX,kBAAC,EAAD,MACA,yBAAKA,UAAU,kBACX,6CACA,6BACA,kBAACwI,EAAA,EAAD,KAEI,kBAACA,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,oBACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOkI,YAAY,oBAAoB3B,MAAO1E,KAAKI,MAAM4H,SAASvE,aAAe,GAAI6C,SAAUtG,KAAKiI,iBACvH,kBAACc,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cAChBP,KAAKI,MAAM0E,OAAOoD,mBAI3B,kBAACa,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,oBACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOkI,YAAY,oBAAoB3B,MAAO1E,KAAKI,MAAM4H,SAASrE,aAAe,GAAI2C,SAAUtG,KAAK8H,iBACvH,kBAACiB,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cAChBP,KAAKI,MAAM0E,OAAOiD,mBAI3B,kBAACgB,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,kBACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOkI,YAAY,oBAAoB3B,MAAO1E,KAAKI,MAAM4H,SAAS5E,KAAO,GAAIkD,SAAUtG,KAAKmI,YAC/G,kBAACY,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cAChBP,KAAKI,MAAM0E,OAAOsD,WAI3B,kBAACW,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,mBACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOkI,YAAY,oBAAoB3B,MAAO1E,KAAKI,MAAM4H,SAASjE,cAAgB,GAAIuC,SAAUtG,KAAKqI,kBACxH,kBAACU,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cAChBP,KAAKI,MAAM0E,OAAOwD,oBAI3B,kBAACS,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,oBACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOkI,YAAY,oBAAoB3B,MAAO1E,KAAKI,MAAM4H,SAAS/D,YAAc,GAAIqC,SAAUtG,KAAKuI,gBACtH,kBAACQ,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cAChBP,KAAKI,MAAM0E,OAAO0D,kBAI3B,kBAACO,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,cACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOkI,YAAY,oBAAoB3B,MAAO1E,KAAKI,MAAM4H,SAAS9D,OAAS,GAAIoC,SAAUtG,KAAKyI,WACjH,kBAACM,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cAChBP,KAAKI,MAAM0E,OAAO4D,aAI3B,kBAAChI,EAAA,EAAD,CAAQwC,QAAQ,UAAU/E,KAAK,SAASoI,UAAWvG,KAAK2F,cAAehF,QAASX,KAAK2I,QAArF,iBA/RxB,GAAkC9H,aC7BrBuI,G,OAET,WACWzK,EACAgF,EACAF,EACAL,EACAW,EACAE,EACAC,EACA7F,EACAO,GAAqB,yBARrBD,aAQoB,KAPpBgF,cAOoB,KANpBF,cAMoB,KALpBL,MAKoB,KAJpBW,eAIoB,KAHpBE,aAGoB,KAFpBC,QAEoB,KADpB7F,UACoB,KAApBO,aCwBFyK,EAAb,kDAII,WAAmBlJ,GAAa,IAAD,8BAC3B,cAAMA,IAHFgB,YAEuB,IA+BvB2G,eAAiB,SAACvD,GACtB,IACIC,EADEb,EAAcY,EAAKE,OAAOC,MAGhCF,EAAYkD,EAAoB/D,GAEhC,IAAMmB,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOiD,iBAAmBvD,EAC1B,EAAKnE,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UACjCA,EAASrE,YAAcA,EACvB,EAAKtD,SAAS,CAAE2H,cA3CW,EA+CvBC,eAAiB,SAAC1D,GACtB,IACIC,EADEf,EAAcc,EAAKE,OAAOC,MAIhCF,EAAYmD,EAAoBlE,GAEhC,IAAMqB,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOoD,iBAAmB1D,EAC1B,EAAKnE,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UACjCA,EAASvE,YAAcA,EACvB,EAAKpD,SAAS,CAAE2H,cA5DW,EAgEvBG,UAAY,SAAC5D,GACjB,IAAMnB,EAAMmB,EAAKE,OAAOC,MAMxB,IAAMI,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOsD,SHxEJ,GGyEH,EAAK/H,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UACjCA,EAAS5E,IAAMA,EACf,EAAK/C,SAAS,CAAE2H,cA7EW,EAgFvBK,gBAAkB,SAAC9D,GACvB,IAAMR,EAAeQ,EAAKE,OAAOC,MAKjC,IAAMI,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAOwD,kBHnFJ,GGoFH,EAAKjI,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UACjCA,EAASjE,aAAeA,EACxB,EAAK1D,SAAS,CAAE2H,cA5FW,EA+FvBO,cAAgB,SAAChE,GACrB,IAAMN,EAAaM,EAAKE,OAAOC,MAK/B,IAAMI,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAO0D,gBH9FJ,GG+FH,EAAKnI,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UACjCA,EAAS/D,WAAaA,EACtB,EAAK5D,SAAS,CAAE2H,cA3GW,EA+GvBS,SAAW,SAAClE,GAChB,IACIC,EADEN,GAASK,EAAKE,OAAOC,MAI3BF,EAAYoD,EAAc1D,GAE1B,IAAMY,EAAM,eAAQ,EAAK1E,MAAM0E,QAC/BA,EAAO4D,WAAalE,EACpB,EAAKnE,SAAS,CAAEyE,WAEhB,IAAMkD,EAAQ,eAAQ,EAAK5H,MAAM4H,UACjCA,EAAS9D,MAAQA,EACjB,EAAK7D,SAAS,CAAE2H,cA5HW,EA0IvBsB,IA1IuB,sBA0IjB,oCAAAjI,EAAA,+EAEiBE,IAAMC,KAAoBV,EAAOC,UAAY,iBAChE,EAAKX,MAAM4H,UAHT,OAEAtG,EAFA,QAIA6H,EAAgB7H,EAASC,MACjBtD,QAAU,EACxBkL,EAAcxF,aAAewD,EAAagC,EAAcxF,cACxDwF,EAActF,WAAasD,EAAagC,EAActF,YACtDnG,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWsB,eAAgBP,QAASiL,IAC3D,EAAKpI,OAAOM,KAAK,qCAAsC8H,GACvD,EAAKpJ,MAAMyB,QAAQ9C,KAAK,UAVlB,qDAcqC,oCAAvC,eAAoB4C,gBAApB,eAA8BC,MAd5B,wBAgBFhC,eAAeW,QACfuB,MAAK,QAAE,EAAD,KAAoBH,gBAArB,aAAC,EAA8BC,MACpC,EAAKxB,MAAMyB,QAAQ9C,KAAK,UAlBtB,8BAsB0C,wBAAvC,eAAoB4C,gBAApB,eAA8BC,MAtBjC,wBAuBF,EAAKxB,MAAMyB,QAAQ9C,KAAK,UAvBtB,2BA4BF+C,MAAM,EAAD,IA5BH,0DAvIV,EAAKzB,MAAQ,CACT4H,SAAU,IAAIoB,EACdtE,OAAQ,CAAEiD,iBAAkB,IAAKG,iBAAkB,IAAKE,SAAU,IAAKE,kBAAmB,IAAKE,gBAAiB,IAAKE,WAAY,MAL1G,EAJnC,6KAkBa/I,eAAeC,QAAQ,UAAaD,eAAeC,QAAQ,QAlBxE,uBAmBYI,KAAKG,MAAMyB,QAAQ9C,KAAK,UAnBpC,0BAwBkBW,KAAKC,MAAMC,eAAeC,QAAQ,SAAS/B,SACjDmC,KAAKG,MAAMyB,QAAQ9C,KAAK,KAzBpC,OA6BQkB,KAAKmB,OAASgB,IAAGC,QAAQtB,EAAOC,WA7BxC,0IAqIQ,IAAK,IAAM6E,KAAQ5F,KAAKI,MAAM0E,OAC1B,GAA2C,KAAvC9E,KAAKI,MAAM0E,OAAOc,GAAMC,WACxB,OAAO,EAGf,OAAO,IA1If,6CAiLQ7F,KAAKmB,OAAO4F,eAjLpB,+BAsLQ,OACI,yBAAKxG,UAAU,gBACX,kBAAC,EAAD,MACA,yBAAKA,UAAU,kBACX,4CACA,6BACA,kBAACwI,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,oBACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOkI,YAAY,oBAAoB3B,MAAO1E,KAAKI,MAAM4H,SAASvE,aAAe,GAAI6C,SAAUtG,KAAKiI,iBACvH,kBAACc,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cACoB,KAApCP,KAAKI,MAAM0E,OAAOoD,iBAAuB,GAAKlI,KAAKI,MAAM0E,OAAOoD,mBAIzE,kBAACa,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,oBACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOkI,YAAY,oBAAoB3B,MAAO1E,KAAKI,MAAM4H,SAASrE,aAAe,GAAI2C,SAAUtG,KAAK8H,iBACvH,kBAACiB,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cACoB,KAApCP,KAAKI,MAAM0E,OAAOiD,iBAAuB,GAAK/H,KAAKI,MAAM0E,OAAOiD,mBAIzE,kBAACgB,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,kBACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOkI,YAAY,YAAY3B,MAAO1E,KAAKI,MAAM4H,SAAS5E,KAAO,GAAIkD,SAAUtG,KAAKmI,YACvG,kBAACY,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cACY,KAA5BP,KAAKI,MAAM0E,OAAOsD,SAAe,GAAKpI,KAAKI,MAAM0E,OAAOsD,WAIjE,kBAACW,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,mBACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOuG,MAAO1E,KAAKI,MAAM4H,SAASjE,cAAgB,GAAIuC,SAAUtG,KAAKqI,kBACxF,kBAACU,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cACqB,KAArCP,KAAKI,MAAM0E,OAAOwD,kBAAwB,GAAKtI,KAAKI,MAAM0E,OAAOwD,oBAI1E,kBAACS,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,oBACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOuG,MAAO1E,KAAKI,MAAM4H,SAAS/D,YAAc,GAAIqC,SAAUtG,KAAKuI,gBACtF,kBAACQ,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cACmB,KAAnCP,KAAKI,MAAM0E,OAAO0D,gBAAsB,GAAKxI,KAAKI,MAAM0E,OAAO0D,kBAIxE,kBAACO,EAAA,EAAKC,MAAN,CAAYC,UAAU,iBAClB,kBAACF,EAAA,EAAKG,MAAN,cACA,kBAACH,EAAA,EAAKI,QAAN,CAAchL,KAAK,OAAOkI,YAAY,oBAAoB3B,MAAO1E,KAAKI,MAAM4H,SAAS9D,OAAS,GAAIoC,SAAUtG,KAAKyI,WACjH,kBAACM,EAAA,EAAKrF,KAAN,CAAWnD,UAAU,cACc,KAA9BP,KAAKI,MAAM0E,OAAO4D,WAAiB,GAAK1I,KAAKI,MAAM0E,OAAO4D,aAInE,kBAAChI,EAAA,EAAD,CAAQwC,QAAQ,UAAU/E,KAAK,SAASoI,UAAWvG,KAAK2F,cAAehF,QAASX,KAAKsJ,KAArF,gBA5OpB,GAAiCzI,a,kBCnC1B,SAAS2I,IACZ,IAAMC,EAAEC,KAAKC,MAAoB,IAAdD,KAAKE,UAClBC,EAAEH,KAAKC,MAAoB,IAAdD,KAAKE,UAClBE,EAAEJ,KAAKC,MAAoB,IAAdD,KAAKE,UAExB,MAAM,QAAN,OAAeH,EAAf,YAAoBI,EAApB,YAAyBC,EAAzB,SCiBG,IAAMC,EAAb,kDAKI,WAAmB5J,GAAa,IAAD,8BAC3B,cAAMA,IAJFe,sBAGuB,IAFvBC,YAEuB,EAE3B,EAAKf,MAAQ,CACT5B,UAAWV,EAAMoE,WAAW1D,UAC5BH,QAASP,EAAMoE,WAAW7D,QAC1B2L,sBAAuB,GACvBC,iBAAkB,GAClBC,OAAQ,IAPe,EALnC,8LAqBavK,eAAeC,QAAQ,UAAaD,eAAeC,QAAQ,QArBxE,uBAsBYI,KAAKG,MAAMyB,QAAQ9C,KAAK,UAtBpC,0BA2BkBW,KAAKC,MAAMC,eAAeC,QAAQ,SAAS/B,SACjDmC,KAAKG,MAAMyB,QAAQ9C,KAAK,KA5BpC,OAgCSkB,KAAKmB,OAASgB,IAAGC,QAAQtB,EAAOC,WAGjCf,KAAKkB,iBAAmBpD,EAAMuE,WAAU,WACpC,IAAM7D,EAAYV,EAAMoE,WAAW1D,UAC7BH,EAAUP,EAAMoE,WAAW7D,QACjC,EAAKgC,SAAS,CAAE7B,YAAWH,eAKK,IAAhC2B,KAAKI,MAAM5B,UAAU8D,QAA4C,IAA5BtC,KAAKI,MAAM/B,QAAQiE,OACxDtC,KAAK8G,mBAICkD,EAAwB,GACxBC,EAAmB,GACnBC,EAAS,GAEflK,KAAKI,MAAM5B,UAAUgB,SAAQ,SAAAP,GACrBA,EAAEZ,QAAU,IACZ2L,EAAsBlL,KAAKG,EAAEwE,aAC7BwG,EAAiBnL,KAAKG,EAAEZ,SACxB6L,EAAOpL,KAAK0K,SAKpBxJ,KAAKK,SAAS,CAAE2J,wBAAuBC,mBAAkBC,YAO7DlK,KAAKmB,OAAOuB,GAAG,8BAA8B,SAAAE,GACzC,EAAKkE,qBAET9G,KAAKmB,OAAOuB,GAAG,gCAAgC,SAAAG,GAC3C,EAAKiE,qBAET9G,KAAKmB,OAAOuB,GAAG,8BAAf,sBAA8C,sBAAArB,EAAA,sDAC1C,EAAKyF,kBADqC,4CA1EtD,wSAmFgBvF,IAAMgB,IAAqBzB,EAAOC,UAAU,kBAnF5D,cAkFkBW,EAlFlB,OAoFkBlD,EAAYkD,EAASC,KApFvC,SAuFgBJ,IAAMgB,IAAmBzB,EAAOC,UAAU,gBAvF1D,OAsFkByB,EAtFlB,OAwFkBnE,EAAUmE,EAAUb,KAE1B7D,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWa,eAAgBE,QAASD,IAC3DP,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAWgB,iBAAkBD,QAASE,IAC7DV,EAAM2E,SAAS,CAAEtE,KAAMZ,EAAW+B,0BA5F9C,qDA+FuD,oCAAvC,eAAoBoC,gBAApB,eAA8BC,MA/F9C,wBAgGgBhC,eAAeW,QACfuB,MAAK,QAAE,EAAD,KAAoBH,gBAArB,aAAC,EAA8BC,MACpC3B,KAAKG,MAAMyB,QAAQ9C,KAAK,UAlGxC,2BAuGgB+C,MAAM,EAAD,IAvGrB,QA6GcmI,EAAwB,GACxBC,EAAmB,GACnBC,EAAS,GAIflK,KAAKI,MAAM5B,UAAUgB,SAAQ,SAAAP,GACrBA,EAAEZ,QAAU,IACZ2L,EAAsBlL,KAAKG,EAAEwE,aAC7BwG,EAAiBnL,KAAKG,EAAEZ,SACxB6L,EAAOpL,KAAK0K,SAMpBxJ,KAAKK,SAAS,CAAE2J,wBAAuBC,mBAAkBC,WA7HjE,6JAoIQlK,KAAKkB,mBACLlB,KAAKmB,OAAO4F,eArIpB,+BA0IQ,OAEI,yBAAKxG,UAAU,WACX,kBAAC,EAAD,MACA,6BACA,kBAAC,MAAD,CACIoB,KACI,CACIwI,OAAQnK,KAAKI,MAAM4J,sBACnBI,SAAU,CACN,CACIC,MAAO,UACP1I,KAAM3B,KAAKI,MAAM6J,iBACjBK,gBAAiBtK,KAAKI,MAAM8J,UAK5CK,QAAS,CACLC,OAAQ,CACJC,MAAO,CAAC,CACJC,MAAO,CACHC,aAAa,EACbC,aAAc,SAAUP,EAAOQ,EAAOV,GAElC,GAAIT,KAAKC,MAAMU,KAAWA,EACtB,OAAOA,eApKnD,GAA6BxJ,aCgBhBiK,I,OAAb,kDAII,WAAmB3K,GAAa,IAAD,uBAC3B,cAAMA,IAHFe,sBAEuB,IAuFvB6J,mBAAqB,SAACxG,GAE1B,IAAMyG,EAAQ,eAAQ,EAAK5K,MAAM4K,UACjCA,EAASC,SAAW1G,EAAKE,OAAOC,MAChCsG,EAASE,WAAaF,EAASC,QAAU,EAAK7K,MAAM4H,SAAS9D,MAE7D,EAAK7D,SAAS,CAAE2K,cA7FW,EA0GvBG,KA1GuB,sBA0GhB,gCAAA9J,EAAA,sEAED+J,EAAU,IAAItH,MAChBkH,EAHG,eAGa,EAAK5K,MAAM4K,WACtB/D,KAAOmE,EAJT,SAMgB7J,IAAMC,KAAoBV,EAAOC,UAAY,iBAChEiK,GAPG,OAMDtJ,EANC,OAQPsJ,EAAWtJ,EAASC,KACpB,EAAKxB,MAAMyB,QAAQ9C,KAAK,KATjB,kDAaPuM,QAAQC,IAAR,MAbO,0DA1GgB,OAO3B,EAAKlL,MAAQ,CACT5B,UAAWV,EAAMoE,WAAW1D,UAC5BwM,SAAU,GACVhD,SAAU,GAGVlD,OAAQ,CAAEiD,iBAAkB,GAAIG,iBAAkB,GAAIE,SAAU,GAAIE,kBAAmB,GAAIE,gBAAiB,GAAIE,WAAY,KAbrG,EAJnC,oMA4BQ1I,KAAKkB,iBAAmBpD,EAAMuE,WAAU,WACpC,IAAM7D,EAAYV,EAAMoE,WAAW1D,UACnC,EAAK6B,SAAS,CAAE7B,iBA9B5B,WAsCgBwB,KAAKI,MAAM5B,UAAU8D,OAAS,GAtC9C,8BAwC8BtC,KAAKI,MAAM5B,WAxCzC,IAwCgB,4BAASS,EAA2B,SAC1BN,cAAgBqB,KAAKG,MAAM7C,MAAMwL,OAAO1C,KAC1C4B,EAAQ,eAAS/I,IA1CzC,WAAAyH,EAAA,wDAmDoBnF,IAAMgB,IAAN,UAA4BzB,EAAOC,UAAnC,2BAA+Df,KAAKG,MAAM7C,MAAMwL,OAAO1C,KAnD3G,OAkDsB1E,EAlDtB,OAoDgBsG,EAAWtG,EAASC,KApDpC,QAwDYqG,EAASjE,aAAeiD,EAAagB,EAASjE,cAC9CiE,EAAS/D,WAAa+C,EAAagB,EAAS/D,YAC5CjE,KAAKK,SAAS,CAAE2H,cAGVgD,EA7DlB,eA6DkChL,KAAKI,MAAM4K,WACxBrM,WAAaqJ,EAASrJ,WAC/BqM,EAASrN,SAAW8B,KAAKC,MAAMC,eAAeC,QAAQ,SAASjC,SAC/DqN,EAASO,eAAiBvD,EAAS9D,MACnClE,KAAKK,SAAS,CAAE2K,aAjE5B,+MAuFQhL,KAAKkB,qBAvFb,oCAsGQ,QAAIlB,KAAKI,MAAM4K,SAASE,YAAc,KAtG9C,+BAkIQ,OACI,yBAAK3K,UAAU,oBACX,kBAAC,EAAD,MACA,yBAAKA,UAAU,kBACX,kBAACwC,EAAA,EAAD,CAAMxC,UAAU,iBACZ,kBAACwC,EAAA,EAAKyI,OAAN,KACI,yBAAKjL,UAAU,UACX,yBAAKA,UAAU,MAAM4C,IAAK,4BAA8BnD,KAAKI,MAAM4H,SAAS5E,MAC5E,0BAAM7C,UAAU,eAAeP,KAAKI,MAAM4H,SAASvE,aAAe,MAG1E,kBAACV,EAAA,EAAKM,KAAN,KACI,kBAACN,EAAA,EAAKS,MAAN,qBACA,kBAACT,EAAA,EAAKW,KAAN,KACK1D,KAAKI,MAAM4H,SAASrE,aAAe,IAExC,kBAACZ,EAAA,EAAKS,MAAN,uBACA,kBAACT,EAAA,EAAKW,KAAN,aACU,IAAII,KAAK9D,KAAKI,MAAM4H,SAASjE,cAAcC,eADrD,QAC0E,IAAIF,KAAK9D,KAAKI,MAAM4H,SAAS/D,YAAYD,gBAEnH,kBAACjB,EAAA,EAAKS,MAAN,yBACA,kBAACT,EAAA,EAAKW,KAAN,KACK1D,KAAKI,MAAM4H,SAAS9D,OAAS,GADlC,MAIJ,kBAACnB,EAAA,EAAKyI,OAAN,KACI,yCAEJ,kBAACzI,EAAA,EAAKM,KAAN,KACI,kBAACN,EAAA,EAAKW,KAAN,2BACuB,2BAAOvF,KAAK,OAAOsN,QAAQ,SAASC,QAAS1L,KAAK+K,mBAAmBY,KAAK3L,MAAO0E,MAAO1E,KAAKI,MAAM4K,SAASC,WAGnI,kBAAClI,EAAA,EAAKW,KAAN,qBACkB1D,KAAKI,MAAM4K,SAASE,YAAc,GADpD,KAGA,kBAACnI,EAAA,EAAKW,KAAN,KACI,kBAAChD,EAAA,EAAD,CAAQwC,QAAQ,UAAU/E,KAAK,SAASoI,UAAWvG,KAAK2F,cAAehF,QAASX,KAAKmL,MAArF,gBAvKhC,GAA8BtK,c,mBCRjB+K,GAAb,kDAII,WAAmBzL,GAAa,IAAD,uBAC3B,cAAMA,IAHFe,sBAEuB,SAO3B,EAAKd,MAAQ,CACTyL,UAAW,GACXrN,UAAW,IATY,EAJnC,gMA0BQwB,KAAKkB,iBAAmBpD,EAAMuE,WAAU,WAEpC,IAAM7D,EAAYV,EAAMoE,WAAW1D,UACnC,EAAK6B,SAAS,CAAE7B,iBAIhBA,EAAYV,EAAMoE,WAAW1D,UAjCzC,SAmDgD,IAAhCwB,KAAKI,MAAMyL,UAAUvJ,OAnDrC,gCAqDoBf,IAAMgB,IAAN,UAA8BzB,EAAOC,UAArC,mBArDpB,OAoDsBW,EApDtB,OAsDgBmK,EAAYnK,EAASC,KAtDrC,UAwDgD,IAAhC3B,KAAKI,MAAM5B,UAAU8D,OAxDrC,kCA0DoBf,IAAMgB,IAAN,UAA8BzB,EAAOC,UAArC,mBA1DpB,QAyDsBW,EAzDtB,OA2DgBlD,EAAYkD,EAASC,KA3DrC,0DAiEY0J,QAAQC,IAAR,MAjEZ,QA+EQtL,KAAKK,SAAS,CAAE7B,cAEhBqN,EAAUrM,SAAQ,SAAAsM,GACdA,EAAE9D,SAAWxJ,EAAUwD,MAAK,SAAA/C,GAAC,OAAIA,EAAEN,YAAcmN,EAAEnN,iBAEvDqB,KAAKK,SAAS,CAAEwL,cApFxB,6JA0FQ7L,KAAKkB,qBA1Fb,+BAgGQ,OACI,yBAAKX,UAAU,aACX,kBAAC,EAAD,MAEA,yBAAKA,UAAU,mBACX,yCACA,6BACA,kBAACwL,GAAA,EAAD,CAAOC,SAAO,EAACC,UAAQ,EAACC,OAAK,GACzB,+BACI,4BACI,yCACA,iDACA,2CACA,wCACA,sCAGPlM,KAAKI,MAAMyL,UAAU/I,KAAI,SAAAgJ,GAAC,OACvB,+BACI,4BACI,4BAAKA,EAAEnO,UACP,4BAAKmO,EAAEb,SACP,4BAAKa,EAAEZ,YACP,4BAAKY,EAAE9D,SAASvE,aAChB,4BAAK,IAAIK,KAAKgI,EAAE7E,MAAMjD,4BAxH1D,GAA+BnD,aCflBsL,GAAb,kDAEI,WAAmBhM,GAAa,IAAD,6BAC3B,cAAMA,GACNoB,IAAM6K,aAAaC,QAAQC,KAAI,SAAAC,GAE3B,OADAA,EAAIC,QAAQC,cAAgB,UAAU9M,eAAeC,QAAQ,SACtD2M,KAGXhL,IAAM6K,aAAa1K,SAAS4K,KAAI,SAAAI,GAC5B,OAAOA,KARgB,EAFnC,qDAeQ,OACI,yBAAKnM,UAAU,UACX,kBAAC,IAAD,KACI,kBAAC,IAAD,KACI,kBAAC,IAAD,CACIE,OAAK,EACLkM,KAAM,IACNC,OAAQ,SAAAzM,GAAK,OACT,kBAAC,EAAD,iBACQA,EADR,CACe6C,IAAK,eAI5B,kBAAC,IAAD,CACIvC,OAAK,EACLkM,KAAM,SAAU3J,IAAK,QACrB4J,OAAQ,SAAAzM,GAAK,OACT,kBAAC,EACOA,MAIhB,kBAAC,IAAD,CACIM,OAAK,EACLkM,KAAM,gBAAiB3J,IAAK,eAC5B4J,OAAQ,SAAAzM,GAAK,OACT,kBAAC,EACOA,MAIhB,kBAAC,IAAD,CACIM,OAAK,EACLkM,KAAM,gBAAiB3J,IAAK,WAC5B4J,OAAQ,SAAAzM,GAAK,OACT,kBAAC,GACOA,MAIhB,kBAAC,IAAD,CACIM,OAAK,EACLkM,KAAM,aAAc3J,IAAK,YACzB4J,OAAQ,SAAAzM,GAAK,OACT,kBAAC,GACOA,MAIhB,kBAAC,IAAD,CACIM,OAAK,EACLkM,KAAM,SAAU3J,IAAK,eACrB4J,OAAQ,SAAAzM,GAAK,OACT,kBAAC,EACOA,MAIhB,kBAAC,IAAD,CACIM,OAAK,EACLkM,KAAM,aAAc3J,IAAK,MACzB4J,OAAQ,SAAAzM,GAAK,OACT,kBAAC,EACOA,MAIhB,kBAAC,IAAD,CACIM,OAAK,EACLkM,KAAM,aAAc3J,IAAK,OACzB4J,OAAQ,SAAAzM,GAAK,OACT,kBAAC,EACOA,MAIhB,kBAAC,IAAD,CACIM,OAAK,EACLkM,KAAM,WAAY3J,IAAK,UACvB4J,OAAQ,SAAAzM,GAAK,OACT,kBAAC,EACOA,aAhGxC,GAAyBU,aCRzBgM,IAASD,OACP,kBAAC,IAAME,WAAP,KACE,kBAAC,GAAD,OAEFC,SAASC,eAAe,SxBgIpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBC,MAAK,SAAAC,GACJA,EAAaC,gBAEdC,OAAM,SAAA3I,GACLyG,QAAQzG,MAAMA,EAAM4I,c","file":"static/js/main.546b2826.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","export enum ActionType {\r\n    SaveAllVacations,\r\n    SaveAllFollows,\r\n    PrepareVacationsForUser,\r\n    saveOneVacation,\r\n    addOneVacation,\r\n    deleteOneVacation,\r\n    AddFollow,\r\n    RemoveFollow\r\n}\r\n","\r\nexport class UserModel {\r\n\r\n    public constructor( // Compiler Magic\r\n        public firstName?: string,\r\n        public lastName?: string,\r\n        public userName?: string,\r\n        public password?: string,\r\n        public isAdmin?: boolean,\r\n        ) {\r\n    }\r\n}\r\n","import { createStore } from \"redux\";\r\nimport { reduce } from \"./reducer\";\r\nimport { AppState } from \"./app-state\";\r\n\r\nexport const store = createStore(reduce, new AppState());\r\n\r\n","import { AppState } from \"./app-state\";\r\nimport { Action } from \"./action\";\r\nimport { ActionType } from \"./action-type\";\r\nexport function reduce(oldAppState: AppState, action: Action): AppState {\r\n\r\n    const newAppState = { ...oldAppState }; // Duplicate the old state into a new state.\r\n\r\n    switch (action.type) {\r\n\r\n\r\n        case ActionType.SaveAllFollows:\r\n            newAppState.follows = action.payload;\r\n            break;\r\n\r\n        case ActionType.SaveAllVacations:\r\n            newAppState.vacations = action.payload;\r\n            break;\r\n\r\n        case ActionType.saveOneVacation:\r\n\r\n            for (let i in newAppState.vacations) {\r\n                if (newAppState.vacations[i].vacationId === action.payload.vacationId) {\r\n                    const follows=newAppState.vacations[i].follows;\r\n                    const isFollow=newAppState.vacations[i].isFollow;\r\n                    newAppState.vacations[i] = action.payload;\r\n                    newAppState.vacations[i].follows=follows;\r\n                    newAppState.vacations[i].isFollow=isFollow;\r\n                    \r\n                }\r\n\r\n            }\r\n\r\n            break;\r\n\r\n        case ActionType.addOneVacation:\r\n            newAppState.vacations.push(action.payload);\r\n            break;\r\n\r\n        case ActionType.deleteOneVacation:\r\n            // for(let i in newAppState.vacations){\r\n            newAppState.vacations = newAppState.vacations.filter(v => { return v.vacationId !== action.payload });\r\n            break;\r\n\r\n        case ActionType.AddFollow:\r\n            newAppState.follows.push(action.payload);\r\n            break;\r\n\r\n        case ActionType.RemoveFollow:\r\n            // for(let i in newAppState.vacations){\r\n            newAppState.follows = newAppState.follows.filter(f => { return f.followId !== action.payload });\r\n            break;\r\n\r\n        case ActionType.PrepareVacationsForUser:\r\n            //add per vacation number of followers and if the user is following\r\n            let counter = 0;\r\n            newAppState.vacations.forEach((v) => {\r\n                v.isFollow = false;\r\n                newAppState.follows.forEach((f) => {\r\n                    if (f.vacationId === v.vacationId) {\r\n                        counter++;\r\n                        if (f.userName === JSON.parse(sessionStorage.getItem(\"user\")).userName) {\r\n                            v.isFollow = true;\r\n                        }\r\n                    }\r\n                });\r\n                v.follows = counter;\r\n                counter = 0;\r\n            });\r\n\r\n            //sort array by followed vacations first\r\n            const isFollow = newAppState.vacations.filter((v) => v.isFollow === true);\r\n            const isNotFollow = newAppState.vacations.filter((v) => v.isFollow === false);\r\n            newAppState.vacations = isFollow.concat(isNotFollow);\r\n\r\n            break;\r\n\r\n        default: break;\r\n    }\r\n\r\n    return newAppState;\r\n}","import { VacationModel } from \"../models/vacation-model\";\r\nimport { FollowModel } from \"../models/follow-model\";\r\nimport { UserModel } from \"../models/user-model\";\r\n\r\nexport class AppState {\r\n    \r\n    public vacations: VacationModel[];\r\n    public follows: FollowModel[];\r\n    public user: UserModel;\r\n\r\n    public constructor() {\r\n        this.vacations = [];\r\n        this.follows=[];\r\n        this.user=new UserModel();\r\n    }\r\n}","export class FollowModel {\r\n\r\n    public constructor( // Compiler Magic\r\n        public followId?: number,\r\n        public userName?: string,\r\n        public vacationId?: number) {\r\n    }\r\n}\r\n\r\n","import React, { Component } from \"react\";\r\nimport \"./navBar.css\";\r\nimport Button from 'react-bootstrap/Button';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { UserModel } from \"../../models/user-model\";\r\n\r\ninterface userState {\r\n    user: UserModel\r\n}\r\n\r\n\r\nexport class NavBar extends Component<any, userState>{\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            user: new UserModel()\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (sessionStorage.getItem(\"user\")) {\r\n            const user = JSON.parse(sessionStorage.getItem(\"user\"));\r\n            this.setState({ user });\r\n        }\r\n\r\n    }\r\n\r\n    private logOut() {\r\n        sessionStorage.clear();\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <div className=\"nav-bar\">\r\n                <div className=\"nav-container\">\r\n                    <nav>\r\n                        {this.state.user.isAdmin ? (\r\n                            <ul>\r\n                                <li>\r\n                                    <NavLink to=\"/\" exact>Home</NavLink>\r\n                                </li>\r\n                                <li>\r\n                                    <NavLink to=\"/admin\" exact> Edit Vacation </NavLink>\r\n                                </li>\r\n                                <li>\r\n                                    <NavLink to=\"/admin/add\" exact> Add Vacation</NavLink>\r\n                                </li>\r\n                                <li>\r\n                                    <NavLink to=\"/purchases\" exact> Purchases</NavLink>\r\n                                </li>\r\n                                <li>\r\n                                    <NavLink to=\"/reports\" exact> Reports </NavLink>\r\n                                </li>\r\n                            </ul>\r\n                        ) :\r\n                            <ul>\r\n                                <li>\r\n                                    <NavLink to=\"/\" exact>Home</NavLink>\r\n                                </li>\r\n                            </ul>\r\n\r\n                        }\r\n                        <div className=\"user\">\r\n                            <div> Hello {this.state.user.userName} </div>\r\n\r\n                            <div>\r\n                                <NavLink to=\"/login\" exact>\r\n                                    <Button onClick={this.logOut}>Log out</Button>\r\n                                </NavLink>\r\n                            </div>\r\n                        </div>\r\n\r\n\r\n                    </nav>\r\n\r\n                </div>\r\n                <div className=\"space\">\r\n\r\n                </div>\r\n            </div>\r\n\r\n\r\n\r\n        )\r\n    }\r\n}","export class Config{\r\n\r\n    public static serverUrl;\r\n\r\n    public static _initialize(){\r\n        if(process.env.NODE_ENV === \"production\"){\r\n            Config.serverUrl=\"https://itay-vacations.herokuapp.com\";\r\n        }\r\n\r\n        else{\r\n            Config.serverUrl=\"http://localhost:3000\";\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\nConfig._initialize();","import React, { Component } from \"react\";\r\nimport \"./home.css\";\r\nimport { VacationModel } from \"../../models/vacation-model\";\r\nimport axios, { AxiosError } from \"axios\";\r\nimport { Unsubscribe } from \"redux\";\r\nimport { store } from \"../../redux/store\";\r\nimport { FollowModel } from \"../../models/follow-model\";\r\nimport { ActionType } from \"../../redux/action-type\";\r\nimport Card from 'react-bootstrap/Card';\r\nimport ListGroupItem from 'react-bootstrap/ListGroupItem';\r\nimport ListGroup from 'react-bootstrap/ListGroup';\r\nimport { StarFill } from 'react-bootstrap-icons';\r\nimport io from \"socket.io-client\";\r\nimport { NavBar } from \"../nav-bar/navBar\";\r\nimport { Config } from \"../../config\";\r\nimport { NavLink } from \"react-router-dom\";\r\n\r\n\r\n\r\ninterface VacationsState {\r\n    vacations: VacationModel[];\r\n    follows: FollowModel[];\r\n}\r\n\r\nexport class Home extends Component<any, VacationsState>{\r\n\r\n    private unsubscribeStore: Unsubscribe;\r\n    private socket;\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n\r\n        //get vacations and follows from the store\r\n        this.state = {\r\n            vacations: store.getState().vacations,\r\n            follows: store.getState().follows\r\n        };\r\n\r\n    }\r\n\r\n\r\n\r\n    public async componentDidMount() {\r\n\r\n        //if there is no token, link to the login page\r\n        if (!sessionStorage.getItem(\"token\") || !sessionStorage.getItem(\"user\")) {\r\n            this.props.history.push(\"/login\");\r\n            return;\r\n        }\r\n\r\n        //create connection to the server\r\n         this.socket = io.connect(Config.serverUrl);\r\n\r\n        //if is there any changes in the store get the vacations and the follows from the new store.\r\n        this.unsubscribeStore = store.subscribe(() => {\r\n            const vacations = store.getState().vacations;\r\n            const follows = store.getState().follows;\r\n            this.setState({ vacations, follows });\r\n        });\r\n\r\n        //if the store is empty, get the data with ajax\r\n        if (!(store.getState().follows.length > 0 && store.getState().vacations.length > 0)) {\r\n\r\n            try {\r\n                const response = await\r\n                    axios.get<VacationModel[]>(Config.serverUrl+\"/api/vacations\");\r\n                const vacations = response.data;\r\n\r\n                const response2 = await\r\n                    axios.get<FollowModel[]>(Config.serverUrl+\"/api/follows\");\r\n                const follows = response2.data;\r\n\r\n                store.dispatch({ type: ActionType.SaveAllFollows, payload: follows });\r\n                store.dispatch({ type: ActionType.SaveAllVacations, payload: vacations });\r\n                store.dispatch({ type: ActionType.PrepareVacationsForUser });\r\n            }\r\n\r\n            catch (err) {\r\n                if ((err as AxiosError).response?.data === \"Your login session has expired\") {\r\n                    sessionStorage.clear();\r\n                    this.props.history.push(\"/login\");\r\n                    return;\r\n                }\r\n\r\n                else {\r\n                    alert(err);\r\n                }\r\n            }\r\n        }\r\n\r\n        //listen to actions from the server\r\n        this.socket.on(\"Admin-updated-a-vacation-from-server\", vacationUpdated => {\r\n            store.dispatch({ type: ActionType.saveOneVacation, payload: vacationUpdated });\r\n        });\r\n        this.socket.on(\"added-vacation-from-server\", vacationAdded => {\r\n            store.dispatch({ type: ActionType.addOneVacation, payload: vacationAdded });\r\n        });\r\n        this.socket.on(\"removed-vacation-from-server\", vacationRemoved => {\r\n            store.dispatch({ type: ActionType.deleteOneVacation, payload: vacationRemoved });\r\n        });\r\n        this.socket.on(\"follows-updated-from-server\", async () => {\r\n            const response2 = await\r\n                axios.get<FollowModel[]>(Config.serverUrl+\"/api/follows\");\r\n            const follows = response2.data;\r\n            store.dispatch({ type: ActionType.SaveAllFollows, payload: follows });\r\n            store.dispatch({ type: ActionType.PrepareVacationsForUser });\r\n        });\r\n\r\n    }\r\n\r\n\r\n\r\n    //add a follow for vacation in the database, and emit\r\n    private addFollow = async (vacationId) => {\r\n        const followToAdd = new FollowModel();\r\n        followToAdd.userName = JSON.parse(sessionStorage.getItem(\"user\")).userName;\r\n        followToAdd.vacationId = vacationId;\r\n        try {\r\n            await axios.post<FollowModel>(Config.serverUrl+\"/api/follows\", followToAdd);\r\n            this.socket.emit(\"user-changed-a-follow-from-client\");\r\n        }\r\n\r\n        catch (err) {\r\n            if ((err as AxiosError).response?.data === \"Your login session has expired\") {\r\n                sessionStorage.clear();\r\n                this.props.history.push(\"/login\");\r\n                return;\r\n            }\r\n\r\n            else {\r\n                alert(err);\r\n            }\r\n        }\r\n    }\r\n\r\n    //add a follow for vacation in the database, and emit\r\n    private removeFollow = async (vacationId) => {\r\n\r\n        const userName = JSON.parse(sessionStorage.getItem(\"user\")).userName;\r\n\r\n        const followToRemove = this.state.follows.find(f => {\r\n            return f.userName === userName && f.vacationId === vacationId\r\n        });\r\n\r\n        try {\r\n            await axios.delete(`${Config.serverUrl}/api/follows/${followToRemove.followId}`);\r\n            this.socket.emit(\"user-changed-a-follow-from-client\");\r\n        }\r\n\r\n        catch (err) {\r\n            if ((err as AxiosError).response?.data === \"Your login session has expired\") {\r\n                sessionStorage.clear();\r\n                this.props.history.push(\"/login\");\r\n                return;\r\n            }\r\n\r\n            else {\r\n                alert(err);\r\n            }\r\n        }\r\n    }\r\n\r\n    //disconnect from the server and the store\r\n    \r\n    public componentWillUnmount(): void {\r\n        // this.unsubscribeStore();\r\n        // this.socket.disconnect();\r\n    }\r\n\r\n\r\n\r\n    public render() {\r\n\r\n        return (\r\n            <div className=\"home\">\r\n                <NavBar />\r\n                <div className=\"card-container\">\r\n                    {this.state.vacations.map(v =>\r\n\r\n\r\n                        <Card   key={v.vacationId}>\r\n                            <Card.Img variant=\"top\" className=\"img\" src={\"/assets/images/vacations/\" + v.img} />\r\n                            <Card.Body>\r\n                                {v.isFollow ? <StarFill className=\"star-fill\" color=\"yellow\" size={\"1.5rem\"} onClick={() => this.removeFollow(v.vacationId)} /> : <StarFill className=\"star-fill\" color=\"grey\" size={\"1.5rem\"} onClick={() => this.addFollow(v.vacationId)} />}\r\n\r\n                                <Card.Title>{v.destination}</Card.Title>\r\n                                <Card.Text>\r\n                                    {v.description}\r\n                                </Card.Text>\r\n                            </Card.Body>\r\n                            <ListGroup className=\"list-group-flush\">\r\n                                <ListGroupItem>Follows: {v.follows}</ListGroupItem>\r\n                                <ListGroupItem>Start: {new Date(v.startingDate).toDateString()}</ListGroupItem>\r\n                                <ListGroupItem>end: {new Date(v.endingDate).toDateString()}</ListGroupItem>\r\n                                <ListGroupItem>Cost: {v.price}$</ListGroupItem>\r\n                                <ListGroupItem><NavLink className=\"purchase\" to={\"/purchase/\"+v.vacationId} exact> purchase </NavLink></ListGroupItem>\r\n                            </ListGroup>\r\n                        </Card>\r\n                    )}\r\n                </div>\r\n\r\n            </div>\r\n        );\r\n    }\r\n}","export function validateAvailableUserName(userName,usersNames){\r\n    let error=\"\";\r\n    usersNames.forEach(user=>{\r\n        if(userName===user.userName){\r\n            error=\"user name is not available\";\r\n        }\r\n    });\r\n    return error;\r\n}\r\n\r\nexport function validateUserName(userName){\r\n\r\n    if (userName === \"\") {\r\n        return \"Missing user name\";\r\n    }\r\n\r\n    else if(userName.length < 2){\r\n        return \"User name too short\";\r\n    }\r\n\r\n    else if (userName.length > 15) {\r\n        return \"User name too long\";\r\n    }\r\n    return \"\";\r\n}\r\n\r\n\r\nexport function validateFirstName(firstName){\r\n    if (firstName === \"\") {\r\n        return \"Missing first name\";\r\n    }\r\n\r\n    else if(firstName.length < 2){\r\n        return  \"first name is too short\";\r\n    }\r\n    \r\n    else if (firstName.length > 10) {\r\n        return  \"first name is too long\";\r\n    }\r\n\r\n    else if(!('A'<=firstName[0] && firstName[0] <='Z')){\r\n        return  \"first name must start with a capital letter\";\r\n    }\r\n\r\n    return \"\";\r\n}\r\n\r\n\r\nexport function validateLastName(lastName){\r\n    if (lastName === \"\") {\r\n        return  \"Missing last name\";\r\n    }\r\n\r\n    else if(lastName.length < 2){\r\n        return  \"last name is too short\";\r\n    }\r\n    \r\n    else if (lastName.length > 10) {\r\n        return  \"last name is too long\";\r\n    }\r\n\r\n    else if(!('A'<=lastName[0] && lastName[0] <='Z')){\r\n        return  \"first name must start with a capital letter\";\r\n    }\r\n\r\n    return \"\";\r\n}\r\n\r\n\r\n\r\nexport function validatePassword(password){\r\n    if (password === \"\") {\r\n        return \"Missing password\";\r\n    }\r\n\r\n    else if(password.length < 6){\r\n        return \"password is too short\";\r\n    }\r\n    \r\n    else if (password.length > 10) {\r\n        return \"password is too long\";\r\n    }\r\n    return \"\";\r\n}\r\n\r\nexport function verifyPassword(verifyPassword,password){\r\n    if(verifyPassword===\"\"){\r\n        return \"Missing verified password\";\r\n    }\r\n    else if (verifyPassword !== password) {\r\n        return \"verify password\";\r\n    }\r\n    return \"\";\r\n}","import React, { Component, ChangeEvent } from \"react\";\r\nimport \"./registration.css\";\r\nimport axios from \"axios\";\r\nimport { UserModel } from \"../../models/user-model\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport {\r\n    validateAvailableUserName,\r\n    validateUserName,\r\n    validateFirstName,\r\n    validateLastName,\r\n    validatePassword,\r\n    verifyPassword\r\n}\r\n    from \"../../services/user-validation\";\r\nimport { Config } from \"../../config\";\r\nimport Button from 'react-bootstrap/Button';\r\n\r\ninterface UserState {\r\n    user: UserModel;\r\n    usersNames: UserModel[];\r\n    errors: {\r\n        userNameError: string,\r\n        firstNameError: string,\r\n        lastNameError: string,\r\n        passwordError: string,\r\n        verifyPasswordError: string\r\n    };\r\n\r\n}\r\n\r\nexport class Registration extends Component<any, UserState>{\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n        this.state = {\r\n            user: new UserModel(),\r\n            usersNames: [],\r\n            errors: { userNameError: \"*\", firstNameError: \"*\", lastNameError: \"*\", passwordError: \"*\", verifyPasswordError: \"*\" }\r\n        };\r\n    }\r\n\r\n    private setUserName = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const userName = args.target.value;\r\n\r\n        let nameError;\r\n\r\n        nameError = validateAvailableUserName(userName, this.state.usersNames);\r\n        if (nameError !== \"user name is not available\") {\r\n            nameError = validateUserName(userName);\r\n        }\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.userNameError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const user = { ...this.state.user };\r\n        user.userName = userName;\r\n        this.setState({ user });\r\n    }\r\n\r\n    private setFirstName = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const firstName = args.target.value;\r\n\r\n        let nameError = validateFirstName(firstName);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.firstNameError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const user = { ...this.state.user };\r\n        user.firstName = firstName;\r\n        this.setState({ user });\r\n\r\n    }\r\n\r\n    private setLastName = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const lastName = args.target.value;\r\n\r\n        let nameError = validateLastName(lastName);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.lastNameError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const user = { ...this.state.user };\r\n        user.lastName = lastName;\r\n        this.setState({ user });\r\n\r\n    }\r\n\r\n    private setPassword = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const password = args.target.value;\r\n\r\n        let nameError = validatePassword(password);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.passwordError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const user = { ...this.state.user };\r\n        user.password = password;\r\n        this.setState({ user });\r\n\r\n    }\r\n\r\n    private verifyPasswordUser = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const verifiedPassword = args.target.value;\r\n        const user = { ...this.state.user };\r\n\r\n        let nameError = verifyPassword(verifiedPassword, user.password);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.verifyPasswordError = nameError;\r\n        this.setState({ errors });\r\n    }\r\n\r\n    private isFormLegal = () => {\r\n        for (const prop in this.state.errors) {\r\n            if (this.state.errors[prop].toString() !== \"\") {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    private register = async () => {\r\n\r\n        try {\r\n            const response = await axios.post(Config.serverUrl + \"/api/auth/register\",\r\n                this.state.user);\r\n\r\n            sessionStorage.setItem(\"user\", JSON.stringify(response.data.user));\r\n            sessionStorage.setItem(\"token\", response.data.token);\r\n\r\n            this.props.history.push(\"/\");\r\n        }\r\n\r\n        catch (err) {\r\n            alert(err);\r\n        }\r\n\r\n    }\r\n\r\n    public async getAllUsersNames() {\r\n        try {\r\n            const response = await axios.get<UserModel[]>(Config.serverUrl + \"/api/auth/usersNames\");\r\n            const usersNames = response.data;\r\n\r\n            this.setState({ usersNames });\r\n        }\r\n\r\n        catch (err) {\r\n            alert(err);\r\n        }\r\n    }\r\n\r\n\r\n    public componentDidMount() {\r\n        //if the user is logged in, navigate to home page\r\n        if (sessionStorage.getItem(\"token\")) {\r\n            this.props.history.push(\"/\");\r\n            return;\r\n        }\r\n\r\n        this.getAllUsersNames();\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <div className=\"registration\">\r\n                <div className=\"card-registration\">\r\n                    <h1>Sign up</h1>\r\n                    <form action=\"\">\r\n                        <div className=\"input-box\">\r\n                            <input type=\"text\" name=\"\" id=\"userBox\" placeholder=\"User Name\" onChange={this.setUserName} />\r\n                            <span className=\"error\">{this.state.errors.userNameError == \"*\" ? \"\" : this.state.errors.userNameError}</span>\r\n                        </div>\r\n                        <div className=\"input-box\">\r\n                            <input type=\"text\" name=\"\" id=\"userBox\" placeholder=\"First Name\" onChange={this.setFirstName} />\r\n                            <span className=\"error\">{this.state.errors.firstNameError == \"*\" ? \"\" : this.state.errors.firstNameError}</span>\r\n                        </div>\r\n                        <div className=\"input-box\">\r\n                            <input type=\"text\" name=\"\" id=\"userBox\" placeholder=\"Last Name\" onChange={this.setLastName} />\r\n                            <span className=\"error\">{this.state.errors.lastNameError == \"*\" ? \"\" : this.state.errors.lastNameError}</span>\r\n                        </div>\r\n                        <div className=\"input-box\">\r\n                            <input type=\"password\" name=\"\" id=\"userBox\" placeholder=\"Password\" onChange={this.setPassword} />\r\n                            <span className=\"error\">{this.state.errors.passwordError == \"*\" ? \"\" : this.state.errors.passwordError}</span>\r\n                        </div>\r\n                        <div className=\"input-box\">\r\n                            <input type=\"password\" name=\"\" id=\"userBox\" placeholder=\"Verify Password\" onChange={this.verifyPasswordUser} />\r\n                            <span className=\"error\">{this.state.errors.verifyPasswordError == \"*\" ? \"\" : this.state.errors.verifyPasswordError}</span>\r\n                        </div>\r\n                        <Button variant=\"primary\" type=\"submit\" disabled={!this.isFormLegal()} onClick={this.register}>Sign up</Button>\r\n\r\n                    </form>\r\n                    <NavLink className=\"navigate\" to=\"/login\" exact>Do you have an account? <br /> Sign in now</NavLink>\r\n\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}","import React, { Component, ChangeEvent } from \"react\";\r\nimport \"./login.css\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport axios, { AxiosError } from \"axios\";\r\nimport { UserModel } from \"../../models/user-model\";\r\nimport { validateUserName, validatePassword } from \"../../services/user-validation\";\r\nimport { Config } from \"../../config\";\r\nimport Button from 'react-bootstrap/Button';\r\n\r\n\r\n\r\ninterface UserState {\r\n    user: UserModel;\r\n    errors: {\r\n        userNameError: string,\r\n        passwordError: string,\r\n    };\r\n}\r\n\r\nexport class Login extends Component<any, UserState>{\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n        this.state = {\r\n            user: new UserModel(),\r\n            errors: { userNameError: \"*\", passwordError: \"*\" }\r\n\r\n        };\r\n    }\r\n\r\n    private setUserName = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const userName = args.target.value;\r\n\r\n        let nameError = validateUserName(userName);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.userNameError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const user = { ...this.state.user };\r\n        user.userName = userName;\r\n        this.setState({ user });\r\n\r\n    }\r\n\r\n    private setPassword = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const password = args.target.value;\r\n\r\n        let nameError = validatePassword(password);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.passwordError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const user = { ...this.state.user };\r\n        user.password = password;\r\n        this.setState({ user });\r\n    }\r\n\r\n    private login = async (e) => {\r\n\r\n        try {\r\n            e.preventDefault();\r\n            const response = await axios.post(Config.serverUrl + \"/api/auth/login\",\r\n                this.state.user);\r\n\r\n            sessionStorage.setItem(\"user\", JSON.stringify(response.data.user));\r\n            sessionStorage.setItem(\"token\", response.data.token);\r\n\r\n            this.props.history.push(\"/\");\r\n        }\r\n\r\n        catch (err) {\r\n            if ((err as AxiosError).response?.data === \"Illegal username or password\") {\r\n                alert((err as AxiosError).response?.data);\r\n                return;\r\n            }\r\n\r\n            else {\r\n                alert(err);\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n\r\n    //check if the form is legal\r\n    private isFormLegal = () => {\r\n        for (const prop in this.state.errors) {\r\n            if (this.state.errors[prop].toString() !== \"\") {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n\r\n    public componentDidMount() {\r\n        //if the user is logged in, navigate to Home page\r\n        if (sessionStorage.getItem(\"token\") && JSON.parse(sessionStorage.getItem(\"user\"))) {\r\n            this.props.history.push(\"/\");\r\n            return;\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <div className=\"login\">\r\n                <div className=\"card-login\">\r\n                    <form className=\"form-login\" onSubmit={this.login}>\r\n                        <h1>Login</h1>\r\n                        <input type=\"text\" name=\"\" id=\"userBox\" placeholder=\"User Name\" onChange={this.setUserName} />\r\n                        <input type=\"password\" name=\"\" id=\"userBox\" placeholder=\"Password\" onChange={this.setPassword} />\r\n                        <br />\r\n                        {/* <button disabled={!this.isFormLegal()} onClick={this.login}>Login</button> */}\r\n                        <Button variant=\"primary\" type=\"submit\" disabled={!this.isFormLegal()} >\r\n                            Login\r\n                        </Button >\r\n                    </form>\r\n                    <NavLink className=\"navigate\" to=\"/registration\" exact>Not a member? Sign up now</NavLink>\r\n\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}","import React, { Component } from \"react\";\r\nimport \"./admin.css\";\r\nimport { VacationModel } from \"../../models/vacation-model\";\r\nimport axios, { AxiosError } from \"axios\";\r\nimport { Unsubscribe } from \"redux\";\r\nimport { store } from \"../../redux/store\";\r\nimport { ActionType } from \"../../redux/action-type\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport Card from 'react-bootstrap/Card';\r\nimport ListGroupItem from 'react-bootstrap/ListGroupItem';\r\nimport ListGroup from 'react-bootstrap/ListGroup';\r\nimport { X } from 'react-bootstrap-icons';\r\nimport { Pencil } from 'react-bootstrap-icons';\r\nimport io from \"socket.io-client\";\r\nimport { NavBar } from \"../nav-bar/navBar\";\r\nimport { Config } from \"../../config\";\r\n\r\n\r\n\r\ninterface VacationsState {\r\n    vacations: VacationModel[];\r\n}\r\n\r\nexport class Admin extends Component<any, VacationsState>{\r\n\r\n    private unsubscribeStore: Unsubscribe;\r\n    private socket;\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n\r\n        //get vacations from the store\r\n        this.state = {\r\n            vacations: store.getState().vacations\r\n        };\r\n    }\r\n\r\n    public async componentDidMount() {\r\n        \r\n        //if there is no token, link to the login page\r\n        if (!sessionStorage.getItem(\"token\") || !sessionStorage.getItem(\"user\")) {\r\n            this.props.history.push(\"/login\");\r\n            return;\r\n        }\r\n\r\n        //if user is not admin, link to the Home page\r\n        else if (!JSON.parse(sessionStorage.getItem(\"user\")).isAdmin) {\r\n            this.props.history.push(\"/\");\r\n        }\r\n\r\n        //create connection to the server\r\n         this.socket = io.connect(Config.serverUrl);\r\n\r\n        //if is there any changes in the store get the vacations from the new store.\r\n        this.unsubscribeStore = store.subscribe(() => {\r\n            const vacations = store.getState().vacations;\r\n            this.setState({ vacations });\r\n        });\r\n\r\n\r\n        // if the store is not empty, cancel the function and don't use axios\r\n        if (this.state.vacations.length > 0) {\r\n            return;\r\n        }\r\n\r\n        //if the store is empty, get the data with ajax\r\n        this.getDataWithAjax();\r\n\r\n        //listen to actions from the server\r\n        this.socket.on(\"Admin-updated-a-vacation-from-server\", vacationUpdated => {\r\n            store.dispatch({ type: ActionType.saveOneVacation, payload: vacationUpdated });\r\n        });\r\n        this.socket.on(\"added-vacation-from-server\", vacationAdded => {\r\n            store.dispatch({ type: ActionType.addOneVacation, payload: vacationAdded });\r\n        });\r\n        this.socket.on(\"removed-vacation-from-server\", vacationRemoved => {\r\n            store.dispatch({ type: ActionType.deleteOneVacation, payload: vacationRemoved });\r\n        });\r\n\r\n\r\n    }\r\n\r\n    //disconnect from the server and the store\r\n    public componentWillUnmount(): void {\r\n        this.unsubscribeStore();\r\n        this.socket.disconnect();\r\n    }\r\n\r\n    //function for getting the vacations with ajax and save in the store\r\n    private getDataWithAjax= async ()=>{\r\n        try {\r\n            const response = await\r\n                axios.get<VacationModel[]>(Config.serverUrl+\"/api/vacations\");\r\n            const vacations = response.data;\r\n            store.dispatch({ type: ActionType.SaveAllVacations, payload: vacations });\r\n        }\r\n\r\n        catch (err) {\r\n            if ((err as AxiosError).response?.data === \"Your login session has expired\") {\r\n                sessionStorage.clear();\r\n                alert((err as AxiosError).response?.data);\r\n                this.props.history.push(\"/login\");\r\n                return;\r\n            }\r\n\r\n            else {\r\n                alert(err);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    //delete a vacation from the database and the store, and emit\r\n    private async delete(vacationId) {\r\n        try {\r\n            await axios.delete(`${Config.serverUrl}/api/vacations/${vacationId}`);\r\n            store.dispatch({ type: ActionType.deleteOneVacation, payload: vacationId });\r\n            this.socket.emit(\"Admin-removed-a-vacation-from-client\", vacationId);\r\n        }\r\n\r\n        catch (err) {\r\n            if ((err as AxiosError).response?.data === \"Your login session has expired\") {\r\n                sessionStorage.clear();\r\n                alert((err as AxiosError).response?.data);\r\n                this.props.history.push(\"/login\");\r\n                return;\r\n            }\r\n\r\n            else {\r\n                alert(err);\r\n            }\r\n        }\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <div className=\"home\">\r\n                <NavBar />\r\n                <div className=\"card-container\">\r\n                {this.state.vacations.map(v =>\r\n\r\n                    <Card key={v.vacationId}>\r\n                        <Card.Img variant=\"top\" className=\"img\" src={\"/assets/images/vacations/\"+v.img} />\r\n                        <Card.Body>\r\n                            <X className=\"delete\" color=\"black\" size={\"1.5rem\"} onClick={() => this.delete(v.vacationId)} />\r\n                            <NavLink to={\"/admin/\" + v.vacationId}>\r\n                                <Pencil color=\"black\" size={\"1.5rem\"} />\r\n                            </NavLink>\r\n                            <Card.Title>{v.destination}</Card.Title>\r\n                            <Card.Text>\r\n                                {v.description}\r\n                            </Card.Text>\r\n\r\n                        </Card.Body>\r\n                        <ListGroup className=\"list-group-flush\">\r\n                            <ListGroupItem>Start: {new Date(v.startingDate).toDateString()}</ListGroupItem>\r\n                            <ListGroupItem>end: {new Date(v.endingDate).toDateString()}</ListGroupItem>\r\n                            <ListGroupItem>Cost: {v.price}$</ListGroupItem>\r\n                        </ListGroup>\r\n                    </Card>\r\n                )}\r\n                </div>\r\n                <br />\r\n\r\n            </div>\r\n        );\r\n    }\r\n}","export function JsonToString(date){\r\n    const d=new Date(date);\r\n    d.setDate(d.getDate()+1);\r\n    const stringDate=d.toISOString();\r\n    const arr=stringDate.split(\"T\");\r\n   return arr[0];\r\n   \r\n}\r\n\r\nexport function StringToJson(date){\r\n    const d=new Date(date);\r\n    d.setDate(d.getDate()-1);\r\n    d.setHours(24);\r\n    const stringDate=d.toJSON();\r\n    return stringDate;\r\n}","\r\nexport function validateDescription(description){\r\n\r\n    if (description === \"\") {\r\n        return \"Missing description\";\r\n    }\r\n\r\n    else if(description.length < 3){\r\n        return \"Description is too short\";\r\n    }\r\n\r\n    else if (description.length > 200) {\r\n        return \"Description is too long\";\r\n    }\r\n    return \"\";\r\n}\r\n\r\n\r\nexport function validateDestination(destination){\r\n    if (destination === \"\") {\r\n        return \"Missing destination\";\r\n    }\r\n\r\n    else if(destination.length < 2){\r\n        return  \"Destination is too short\";\r\n    }\r\n    \r\n    else if (destination.length > 30) {\r\n        return  \"Destination is too long\";\r\n    }\r\n\r\n    else if(!('A'<=destination[0] && destination[0] <='Z')){\r\n        return  \"Destination must start with a capital letter\";\r\n    }\r\n    return \"\";\r\n}\r\n\r\n\r\nexport function validateImgUrl(img){\r\n    return \"\";\r\n}\r\n\r\nexport function validateStartingDate(date){\r\n    return \"\";\r\n}\r\n\r\nexport function validateEndingDate(date){\r\n    return \"\";\r\n\r\n}\r\n\r\n\r\n\r\nexport function validatePrice(price){\r\n\r\n    if (!price) {\r\n        return \"Missing price\";\r\n    }\r\n\r\n    else if(price < 0){\r\n        return \"Price can't be negative\";\r\n    }\r\n    \r\n    else if (price > 50000) {\r\n        return \"Price is too high\";\r\n    }\r\n    return \"\";\r\n}\r\n\r\n","import React, { Component, ChangeEvent } from \"react\";\r\nimport \"./editVacation.css\";\r\nimport { VacationModel } from \"../../models/vacation-model\";\r\nimport axios, { AxiosError } from \"axios\";\r\nimport { Unsubscribe } from \"redux\";\r\nimport { store } from \"../../redux/store\";\r\nimport { JsonToString } from \"../../services/date\";\r\nimport { StringToJson } from \"../../services/date\";\r\nimport { validateDescription, validateDestination, validateImgUrl, validateStartingDate, validateEndingDate, validatePrice } from \"../../services/vacation-validation\";\r\nimport Button from 'react-bootstrap/Button';\r\nimport Form from 'react-bootstrap/Form';\r\nimport io from \"socket.io-client\";\r\nimport { NavBar } from \"../nav-bar/navBar\";\r\nimport { ActionType } from \"../../redux/action-type\";\r\nimport { Config } from \"../../config\";\r\n\r\ninterface VacationState {\r\n    vacations: VacationModel[];\r\n    vacation: VacationModel;\r\n    errors: {\r\n        descriptionError: string,\r\n        destinationError: string,\r\n        imgError: string,\r\n        startingDateError: string,\r\n        endingDateError: string,\r\n        priceError: string\r\n    };\r\n}\r\n\r\nexport class EditVacation extends Component<any, VacationState>{\r\n\r\n    private unsubscribeStore: Unsubscribe;\r\n    private socket;\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n\r\n        //get vacations from the store\r\n        this.state = {\r\n            vacations: store.getState().vacations,\r\n            vacation: {},\r\n            errors: { descriptionError: \"\", destinationError: \"\", imgError: \"\", startingDateError: \"\", endingDateError: \"\", priceError: \"\" }\r\n        };\r\n\r\n    }\r\n\r\n\r\n\r\n    public async componentDidMount() {\r\n\r\n\r\n        //create connection to the server\r\n         this.socket = io.connect(Config.serverUrl);\r\n\r\n\r\n        //if is there any changes in the store get the vacations from the new store.\r\n        this.unsubscribeStore = store.subscribe(() => {\r\n            const vacations = store.getState().vacations;\r\n            this.setState({ vacations });\r\n        });\r\n\r\n        //if there is no token, link to the login page\r\n        if (!sessionStorage.getItem(\"token\") || !sessionStorage.getItem(\"user\")) {\r\n            this.props.history.push(\"/login\");\r\n            return;\r\n        }\r\n\r\n        //if user is not admin, link to the Home page\r\n        else if (!JSON.parse(sessionStorage.getItem(\"user\")).isAdmin) {\r\n            this.props.history.push(\"/\");\r\n        }\r\n\r\n\r\n\r\n        let vacation;\r\n\r\n        //if the store is not empty, find the vacation for edit and don't use axios at all\r\n        if (this.state.vacations.length > 0) {\r\n\r\n            for (let v of this.state.vacations) {\r\n                if (v.vacationId === +this.props.match.params.id) {\r\n                    vacation = ({ ...v });\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        // if the store is empty, get the vacation for edit with axios\r\n        else {\r\n            try {\r\n                const response = await\r\n                    axios.get<VacationModel>(`${Config.serverUrl}/api/vacations/${+this.props.match.params.id}`);\r\n                vacation = response.data;\r\n\r\n            }\r\n\r\n\r\n            catch (err) {\r\n                if ((err as AxiosError).response?.data === \"Your login session has expired\") {\r\n                    sessionStorage.clear();\r\n                    alert(err);\r\n                    // this.props.history.push(\"/login\");\r\n                    return;\r\n                }\r\n\r\n                else {\r\n                    alert((err as AxiosError).response?.data);\r\n                }\r\n\r\n            }\r\n\r\n\r\n\r\n        }\r\n\r\n        //treatment with json date format\r\n        vacation.startingDate = JsonToString(vacation.startingDate);\r\n        vacation.endingDate = JsonToString(vacation.endingDate);\r\n        this.setState({ vacation });\r\n\r\n    }\r\n\r\n    //disconnect from the server and the store\r\n    public componentWillUnmount(): void {\r\n        this.unsubscribeStore();\r\n        this.socket.disconnect();\r\n    }\r\n\r\n    //get the data from inputs to the state\r\n    public setDescription = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const description = args.target.value;\r\n        let nameError;\r\n\r\n        nameError = validateDescription(description);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.descriptionError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        vacation.description = description;\r\n        this.setState({ vacation });\r\n    }\r\n    public setDestination = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const destination = args.target.value;\r\n        let nameError;\r\n\r\n        nameError = validateDestination(destination);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.destinationError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        vacation.destination = destination;\r\n        this.setState({ vacation });\r\n    }\r\n\r\n    public setImgUrl = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const img = args.target.value;\r\n        let nameError;\r\n\r\n        nameError = validateImgUrl(img);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.imgError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        vacation.img = img;\r\n        this.setState({ vacation });\r\n    }\r\n    public setStartingDate = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const startingDate = args.target.value;\r\n        let nameError;\r\n\r\n        nameError = validateStartingDate(startingDate);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.startingDateError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        // vacation.startingDate=new Date(startingDate).toJSON();\r\n        vacation.startingDate = startingDate;\r\n        this.setState({ vacation });\r\n    }\r\n    public setEndingDate = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const endingDate = args.target.value;\r\n        let nameError;\r\n\r\n        nameError = validateEndingDate(endingDate);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.endingDateError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        // vacation.endingDate = new Date(endingDate).toJSON();\r\n        vacation.endingDate = endingDate;\r\n        this.setState({ vacation });\r\n    }\r\n\r\n    private setPrice = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const price = +args.target.value;\r\n        let nameError;\r\n\r\n        nameError = validatePrice(price);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.priceError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        vacation.price = price;\r\n        this.setState({ vacation });\r\n    }\r\n\r\n    private isFormLegal() {\r\n        for (const prop in this.state.errors) {\r\n            if (this.state.errors[prop].toString() !== \"\") {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    public update = async () => {\r\n        try {\r\n            const vacationToUpdate = { ...this.state.vacation }\r\n            await axios.put(`${Config.serverUrl}/api/vacations/${+this.props.match.params.id}`,\r\n                vacationToUpdate);\r\n            vacationToUpdate.startingDate = StringToJson(vacationToUpdate.startingDate);\r\n            vacationToUpdate.endingDate = StringToJson(vacationToUpdate.endingDate);\r\n            store.dispatch({ type: ActionType.saveOneVacation, payload: vacationToUpdate });\r\n            this.socket.emit(\"Admin-updated-a-vacation-from-client\", vacationToUpdate);\r\n            this.props.history.push(\"/admin\");\r\n        }\r\n\r\n        catch (err) {\r\n            if ((err as AxiosError).response?.data === \"Your login session has expired\") {\r\n                sessionStorage.clear();\r\n                alert((err as AxiosError).response?.data);\r\n                this.props.history.push(\"/login\");\r\n                return;\r\n            }\r\n\r\n            else if ((err as AxiosError).response?.data === \"You are not admin!\") {\r\n                this.props.history.push(\"/login\");\r\n                return;\r\n            }\r\n\r\n            else {\r\n                alert(err);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    public render() {\r\n        return (\r\n            <div className=\"EditVacation\">\r\n                <NavBar />\r\n                <div className=\"form-container\">\r\n                    <h1>Edit Vacation</h1>\r\n                    <br />\r\n                    <Form>\r\n\r\n                        <Form.Group controlId=\"formBasicText\">\r\n                            <Form.Label>Destination</Form.Label>\r\n                            <Form.Control type=\"text\" placeholder=\"Enter description\" value={this.state.vacation.destination || \"\"} onChange={this.setDestination} />\r\n                            <Form.Text className=\"text-muted\">\r\n                                {this.state.errors.destinationError}\r\n                            </Form.Text>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group controlId=\"formBasicText\">\r\n                            <Form.Label>Description</Form.Label>\r\n                            <Form.Control type=\"text\" placeholder=\"Enter description\" value={this.state.vacation.description || \"\"} onChange={this.setDescription} />\r\n                            <Form.Text className=\"text-muted\" >\r\n                                {this.state.errors.descriptionError}\r\n                            </Form.Text>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group controlId=\"formBasicText\">\r\n                            <Form.Label>Image URL</Form.Label>\r\n                            <Form.Control type=\"text\" placeholder=\"Enter description\" value={this.state.vacation.img || \"\"} onChange={this.setImgUrl} />\r\n                            <Form.Text className=\"text-muted\" >\r\n                                {this.state.errors.imgError}\r\n                            </Form.Text>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group controlId=\"formBasicText\">\r\n                            <Form.Label>Start Date</Form.Label>\r\n                            <Form.Control type=\"date\" placeholder=\"Enter description\" value={this.state.vacation.startingDate || \"\"} onChange={this.setStartingDate} />\r\n                            <Form.Text className=\"text-muted\">\r\n                                {this.state.errors.startingDateError}\r\n                            </Form.Text>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group controlId=\"formBasicText\">\r\n                            <Form.Label>Ending Date</Form.Label>\r\n                            <Form.Control type=\"date\" placeholder=\"Enter description\" value={this.state.vacation.endingDate || \"\"} onChange={this.setEndingDate} />\r\n                            <Form.Text className=\"text-muted\">\r\n                                {this.state.errors.endingDateError}\r\n                            </Form.Text>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group controlId=\"formBasicText\">\r\n                            <Form.Label>Price</Form.Label>\r\n                            <Form.Control type=\"text\" placeholder=\"Enter description\" value={this.state.vacation.price || \"\"} onChange={this.setPrice} />\r\n                            <Form.Text className=\"text-muted\">\r\n                                {this.state.errors.priceError}\r\n                            </Form.Text>\r\n                        </Form.Group>\r\n\r\n                        <Button variant=\"primary\" type=\"submit\" disabled={!this.isFormLegal()} onClick={this.update}>\r\n                            Submit\r\n                        </Button >\r\n                    </Form>\r\n                </div>\r\n\r\n            </div>\r\n        );\r\n    }\r\n}","export class VacationModel {\r\n\r\n    public constructor( // Compiler Magic\r\n        public vacationId?: number,\r\n        public description?: string,\r\n        public destination?: string,\r\n        public img?: string,\r\n        public startingDate?: string,\r\n        public endingDate?: string,\r\n        public price?: number,\r\n        public follows?: number,\r\n        public isFollow?: boolean) {\r\n    }\r\n}\r\n\r\n","import React, { Component, ChangeEvent } from \"react\";\r\nimport \"./addVacation.css\";\r\nimport { VacationModel } from \"../../models/vacation-model\";\r\nimport axios, { AxiosError } from \"axios\";\r\nimport { store } from \"../../redux/store\";\r\nimport { ActionType } from \"../../redux/action-type\";\r\nimport {\r\n    validateDescription,\r\n    validateDestination,\r\n    validateImgUrl,\r\n    validateStartingDate,\r\n    validateEndingDate,\r\n    validatePrice\r\n} from \"../../services/vacation-validation\";\r\nimport Button from 'react-bootstrap/Button';\r\nimport Form from 'react-bootstrap/Form';\r\nimport io from \"socket.io-client\";\r\nimport { NavBar } from \"../nav-bar/navBar\";\r\nimport { StringToJson } from \"../../services/date\";\r\nimport { Config } from \"../../config\";\r\n\r\n\r\ninterface VacationState {\r\n    vacation: VacationModel;\r\n    errors: {\r\n        descriptionError: string,\r\n        destinationError: string,\r\n        imgError: string,\r\n        startingDateError: string,\r\n        endingDateError: string,\r\n        priceError: string\r\n    };\r\n\r\n}\r\n\r\nexport class AddVacation extends Component<any, VacationState>{\r\n\r\n    private socket;\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            vacation: new VacationModel(),\r\n            errors: { descriptionError: \"*\", destinationError: \"*\", imgError: \"*\", startingDateError: \"*\", endingDateError: \"*\", priceError: \"*\" }\r\n\r\n        };\r\n    }\r\n\r\n\r\n    public async componentDidMount() {\r\n\r\n        //if there is no token, link to the login page\r\n        if (!sessionStorage.getItem(\"token\") || !sessionStorage.getItem(\"user\")) {\r\n            this.props.history.push(\"/login\");\r\n            return;\r\n        }\r\n\r\n        //if user is not admin, link to the Home page\r\n        else if (!JSON.parse(sessionStorage.getItem(\"user\")).isAdmin) {\r\n            this.props.history.push(\"/\");\r\n        }\r\n\r\n        //create connection to the server\r\n        this.socket = io.connect(Config.serverUrl);\r\n    }\r\n\r\n\r\n\r\n    //get the data from inputs to the state\r\n    private setDescription = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const description = args.target.value;\r\n        let nameError;\r\n\r\n        nameError = validateDescription(description);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.descriptionError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        vacation.description = description;\r\n        this.setState({ vacation });\r\n\r\n    }\r\n\r\n    private setDestination = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const destination = args.target.value;\r\n        let nameError;\r\n\r\n\r\n        nameError = validateDestination(destination);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.destinationError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        vacation.destination = destination;\r\n        this.setState({ vacation });\r\n    }\r\n\r\n\r\n    private setImgUrl = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const img = args.target.value;\r\n        let nameError;\r\n\r\n\r\n        nameError = validateImgUrl(img);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.imgError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        vacation.img = img;\r\n        this.setState({ vacation });\r\n    }\r\n\r\n    private setStartingDate = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const startingDate = args.target.value;\r\n        let nameError;\r\n\r\n        nameError = validateStartingDate(startingDate);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.startingDateError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        vacation.startingDate = startingDate;\r\n        this.setState({ vacation });\r\n    }\r\n\r\n    private setEndingDate = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const endingDate = args.target.value;\r\n        let nameError;\r\n\r\n        nameError = validateEndingDate(endingDate);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.endingDateError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        vacation.endingDate = endingDate;\r\n        this.setState({ vacation });\r\n    }\r\n\r\n\r\n    private setPrice = (args: ChangeEvent<HTMLInputElement>) => {\r\n        const price = +args.target.value;\r\n        let nameError;\r\n\r\n\r\n        nameError = validatePrice(price);\r\n\r\n        const errors = { ...this.state.errors };\r\n        errors.priceError = nameError;\r\n        this.setState({ errors });\r\n\r\n        const vacation = { ...this.state.vacation };\r\n        vacation.price = price;\r\n        this.setState({ vacation });\r\n    }\r\n\r\n    //check if the form is legal\r\n    private isFormLegal() {\r\n        for (const prop in this.state.errors) {\r\n            if (this.state.errors[prop].toString() !== \"\") {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    //add a new vacation, to database and store, emit, and redirect to /login\r\n    private add = async () => {\r\n        try {\r\n            const response = await axios.post<VacationModel>(Config.serverUrl + \"/api/vacations\",\r\n                this.state.vacation);\r\n            const addedVacation = response.data;\r\n            addedVacation.follows = 0;\r\n            addedVacation.startingDate = StringToJson(addedVacation.startingDate);\r\n            addedVacation.endingDate = StringToJson(addedVacation.endingDate);\r\n            store.dispatch({ type: ActionType.addOneVacation, payload: addedVacation });\r\n            this.socket.emit(\"Admin-added-a-vacation-from-client\", addedVacation);\r\n            this.props.history.push(\"/admin\");\r\n\r\n        }\r\n        catch (err) {\r\n            if ((err as AxiosError).response?.data === \"Your login session has expired\") {\r\n                // alert(err.response.data);\r\n                sessionStorage.clear();\r\n                alert((err as AxiosError).response?.data);\r\n                this.props.history.push(\"/login\");\r\n                return;\r\n            }\r\n\r\n            else if ((err as AxiosError).response?.data === \"You are not admin!\") {\r\n                this.props.history.push(\"/login\");\r\n                return;\r\n            }\r\n\r\n            else {\r\n                alert(err);\r\n            }\r\n        }\r\n    }\r\n\r\n    //disconnect from the server\r\n    public componentWillUnmount(): void {\r\n        this.socket.disconnect();\r\n    }\r\n\r\n    public render() {\r\n\r\n        return (\r\n            <div className=\"EditVacation\">\r\n                <NavBar />\r\n                <div className=\"edit-container\">\r\n                    <h1>Add Vacation</h1>\r\n                    <br />\r\n                    <Form.Group controlId=\"formBasicText\">\r\n                        <Form.Label>Destination</Form.Label>\r\n                        <Form.Control type=\"text\" placeholder=\"Enter destination\" value={this.state.vacation.destination || \"\"} onChange={this.setDestination} />\r\n                        <Form.Text className=\"text-muted\">\r\n                            {this.state.errors.destinationError==\"*\"? \"\" : this.state.errors.destinationError }\r\n                        </Form.Text>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group controlId=\"formBasicText\">\r\n                        <Form.Label>Description</Form.Label>\r\n                        <Form.Control type=\"text\" placeholder=\"Enter description\" value={this.state.vacation.description || \"\"} onChange={this.setDescription} />\r\n                        <Form.Text className=\"text-muted\">\r\n                            {this.state.errors.descriptionError==\"*\"? \"\" : this.state.errors.descriptionError}\r\n                        </Form.Text>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group controlId=\"formBasicText\">\r\n                        <Form.Label>Image URL</Form.Label>\r\n                        <Form.Control type=\"text\" placeholder=\"Enter img\" value={this.state.vacation.img || \"\"} onChange={this.setImgUrl} />\r\n                        <Form.Text className=\"text-muted\">\r\n                            {this.state.errors.imgError==\"*\"? \"\" : this.state.errors.imgError}\r\n                        </Form.Text>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group controlId=\"formBasicText\">\r\n                        <Form.Label>Start Date</Form.Label>\r\n                        <Form.Control type=\"date\" value={this.state.vacation.startingDate || \"\"} onChange={this.setStartingDate} />\r\n                        <Form.Text className=\"text-muted\">\r\n                            {this.state.errors.startingDateError==\"*\"? \"\" : this.state.errors.startingDateError}\r\n                        </Form.Text>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group controlId=\"formBasicText\">\r\n                        <Form.Label>Ending Date</Form.Label>\r\n                        <Form.Control type=\"date\" value={this.state.vacation.endingDate || \"\"} onChange={this.setEndingDate} />\r\n                        <Form.Text className=\"text-muted\">\r\n                            {this.state.errors.endingDateError==\"*\"? \"\" : this.state.errors.endingDateError}\r\n                        </Form.Text>\r\n                    </Form.Group>\r\n\r\n                    <Form.Group controlId=\"formBasicText\">\r\n                        <Form.Label>Price</Form.Label>\r\n                        <Form.Control type=\"text\" placeholder=\"Enter description\" value={this.state.vacation.price || \"\"} onChange={this.setPrice} />\r\n                        <Form.Text className=\"text-muted\">\r\n                            {this.state.errors.priceError==\"*\"? \"\" : this.state.errors.priceError}\r\n                        </Form.Text>\r\n                    </Form.Group>\r\n\r\n                    <Button variant=\"primary\" type=\"submit\" disabled={!this.isFormLegal()} onClick={this.add}>\r\n                        Submit\r\n                    </Button >\r\n\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}","export function getRandomColor(){\r\n    const r=Math.floor(Math.random()*255);\r\n    const g=Math.floor(Math.random()*255);\r\n    const b=Math.floor(Math.random()*255);\r\n\r\n    return `rgba(${r},${g},${b},0.5)`;\r\n    \r\n}","import React, { Component } from \"react\";\r\nimport \"./reports.css\";\r\nimport { VacationModel } from \"../../models/vacation-model\";\r\nimport { Unsubscribe } from \"redux\";\r\nimport { store } from \"../../redux/store\";\r\nimport { Bar } from 'react-chartjs-2';\r\nimport { FollowModel } from \"../../models/follow-model\";\r\nimport io from \"socket.io-client\";\r\nimport axios, { AxiosError } from \"axios\";\r\nimport { ActionType } from \"../../redux/action-type\";\r\nimport { getRandomColor } from \"../../services/color\";\r\nimport { NavBar } from \"../nav-bar/navBar\";\r\nimport { Config } from \"../../config\";\r\n\r\ninterface reportsState {\r\n    vacations: VacationModel[];\r\n    follows: FollowModel[];\r\n    vacationsDestinations;\r\n    vacationsFollows;\r\n    colors;\r\n}\r\n\r\nexport class Reports extends Component<any, reportsState>{\r\n\r\n    private unsubscribeStore: Unsubscribe;\r\n    private socket;\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n        this.state = {\r\n            vacations: store.getState().vacations,\r\n            follows: store.getState().follows,\r\n            vacationsDestinations: [],\r\n            vacationsFollows: [],\r\n            colors: []\r\n        }\r\n    }\r\n\r\n\r\n\r\n    public async componentDidMount() {\r\n\r\n        //if there is no token, link to the login page\r\n        if (!sessionStorage.getItem(\"token\") || !sessionStorage.getItem(\"user\")) {\r\n            this.props.history.push(\"/login\");\r\n            return;\r\n        }\r\n\r\n        //if user is not admin, link to the Home page\r\n        else if (!JSON.parse(sessionStorage.getItem(\"user\")).isAdmin) {\r\n            this.props.history.push(\"/\");\r\n        }\r\n\r\n        //create connection to the server\r\n         this.socket = io.connect(Config.serverUrl);\r\n\r\n        //if is there any changes in the store get the vacations and the follows from the new store.\r\n        this.unsubscribeStore = store.subscribe(() => {\r\n            const vacations = store.getState().vacations;\r\n            const follows = store.getState().follows;\r\n            this.setState({ vacations, follows });\r\n\r\n        });\r\n\r\n        // if the store is empty get the data with ajax\r\n        if (this.state.vacations.length === 0 || this.state.follows.length===0) {\r\n            this.getDataWithAjax();\r\n        }\r\n\r\n        else {\r\n            const vacationsDestinations = [];\r\n            const vacationsFollows = [];\r\n            const colors = [];\r\n\r\n            this.state.vacations.forEach(v => {\r\n                if (v.follows > 0) {\r\n                    vacationsDestinations.push(v.destination);\r\n                    vacationsFollows.push(v.follows);\r\n                    colors.push(getRandomColor());\r\n                }\r\n\r\n            });\r\n\r\n            this.setState({ vacationsDestinations, vacationsFollows, colors });\r\n\r\n        }\r\n\r\n\r\n\r\n\r\n        this.socket.on(\"added-vacation-from-server\", vacationAdded => {\r\n            this.getDataWithAjax();\r\n        });\r\n        this.socket.on(\"removed-vacation-from-server\", vacationRemoved => {\r\n            this.getDataWithAjax();\r\n        });\r\n        this.socket.on(\"follows-updated-from-server\", async () => {\r\n            this.getDataWithAjax();\r\n        });\r\n\r\n    }\r\n\r\n    private async getDataWithAjax() {\r\n        try {\r\n            const response = await\r\n                axios.get<VacationModel[]>(Config.serverUrl+\"/api/vacations\");\r\n            const vacations = response.data;\r\n\r\n            const response2 = await\r\n                axios.get<FollowModel[]>(Config.serverUrl+\"/api/follows\");\r\n            const follows = response2.data;\r\n\r\n            store.dispatch({ type: ActionType.SaveAllFollows, payload: follows });\r\n            store.dispatch({ type: ActionType.SaveAllVacations, payload: vacations });\r\n            store.dispatch({ type: ActionType.PrepareVacationsForUser });\r\n        }\r\n        catch (err) {\r\n            if ((err as AxiosError).response?.data === \"Your login session has expired\") {\r\n                sessionStorage.clear();\r\n                alert((err as AxiosError).response?.data);\r\n                this.props.history.push(\"/login\");\r\n                return;\r\n            }\r\n\r\n            else {\r\n                alert(err);\r\n            }\r\n\r\n        }\r\n\r\n\r\n        const vacationsDestinations = [];\r\n        const vacationsFollows = [];\r\n        const colors = [];\r\n\r\n\r\n\r\n        this.state.vacations.forEach(v => {\r\n            if (v.follows > 0) {\r\n                vacationsDestinations.push(v.destination);\r\n                vacationsFollows.push(v.follows);\r\n                colors.push(getRandomColor());\r\n            }\r\n\r\n        });\r\n\r\n\r\n        this.setState({ vacationsDestinations, vacationsFollows, colors });\r\n\r\n\r\n\r\n    }\r\n\r\n    public componentWillUnmount(): void {\r\n        this.unsubscribeStore();\r\n        this.socket.disconnect();\r\n    }\r\n\r\n\r\n    public render() {\r\n        return (\r\n\r\n            <div className=\"reports\">\r\n                <NavBar />\r\n                <br></br>\r\n                <Bar\r\n                    data={\r\n                        {\r\n                            labels: this.state.vacationsDestinations,\r\n                            datasets: [\r\n                                {\r\n                                    label: 'Follows',\r\n                                    data: this.state.vacationsFollows,\r\n                                    backgroundColor: this.state.colors\r\n                                }\r\n                            ]\r\n                        }\r\n                    }\r\n                    options={{\r\n                        scales: {\r\n                            yAxes: [{\r\n                                ticks: {\r\n                                    beginAtZero: true,\r\n                                    userCallback: function (label, index, labels) {\r\n                                        // when the floored value is the same as the value we have a whole number\r\n                                        if (Math.floor(label) === label) {\r\n                                            return label;\r\n                                        }\r\n\r\n                                    },\r\n                                }\r\n                            }]\r\n                        }\r\n                    }}\r\n                />\r\n\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n}","import React, { Component, ChangeEvent } from \"react\";\r\nimport \"./purchase.css\";\r\nimport { VacationModel } from \"../../models/vacation-model\";\r\nimport { PurchaseModel } from \"../../models/purchase-model\";\r\n\r\nimport axios from \"axios\";\r\n\r\nimport { Unsubscribe } from \"redux\";\r\nimport { store } from \"../../redux/store\";\r\nimport { ActionType } from \"../../redux/action-type\";\r\n\r\nimport { NavBar } from \"../nav-bar/navBar\";\r\nimport { JsonToString } from \"../../services/date\";\r\nimport { StringToJson } from \"../../services/date\";\r\nimport Card from 'react-bootstrap/Card';\r\n\r\nimport Button from 'react-bootstrap/Button';\r\nimport Form from 'react-bootstrap/Form';\r\n\r\n\r\nimport { Config } from \"../../config\";\r\n\r\ninterface VacationState {\r\n    vacations: VacationModel[];\r\n    purchase: PurchaseModel;\r\n    vacation: VacationModel;\r\n    // numberOfTickets: number;\r\n    // totalPrice: number;\r\n    errors: {\r\n        descriptionError: string,\r\n        destinationError: string,\r\n        imgError: string,\r\n        startingDateError: string,\r\n        endingDateError: string,\r\n        priceError: string\r\n    };\r\n}\r\n\r\nexport class Purchase extends Component<any, VacationState>{\r\n\r\n    private unsubscribeStore: Unsubscribe;\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n\r\n        let numberOfTickets = 0;\r\n        let totalPrice = 0;\r\n\r\n        //get vacations from the store\r\n        this.state = {\r\n            vacations: store.getState().vacations,\r\n            purchase: {},\r\n            vacation: {},\r\n            // numberOfTickets: 0,\r\n            // totalPrice: 0,\r\n            errors: { descriptionError: \"\", destinationError: \"\", imgError: \"\", startingDateError: \"\", endingDateError: \"\", priceError: \"\" }\r\n        };\r\n\r\n    }\r\n\r\n\r\n\r\n    public async componentDidMount() {\r\n\r\n\r\n        //if is there any changes in the store get the vacations from the new store.\r\n        this.unsubscribeStore = store.subscribe(() => {\r\n            const vacations = store.getState().vacations;\r\n            this.setState({ vacations });\r\n        });\r\n\r\n\r\n        try {\r\n            let vacation;\r\n\r\n            //if the store is not empty, find the vacation for edit and don't use axios at all\r\n            if (this.state.vacations.length > 0) {\r\n\r\n                for (let v of this.state.vacations) {\r\n                    if (v.vacationId === +this.props.match.params.id) {\r\n                        vacation = ({ ...v });\r\n                    }\r\n\r\n                }\r\n            }\r\n\r\n            // if the store is empty, get the vacation for edit with axios\r\n            else {\r\n                const response = await\r\n                    axios.get<VacationModel>(`${Config.serverUrl}/api/vacations/${+this.props.match.params.id}`);\r\n                vacation = response.data;\r\n            }\r\n\r\n            //treatment with json date format\r\n            vacation.startingDate = JsonToString(vacation.startingDate);\r\n            vacation.endingDate = JsonToString(vacation.endingDate);\r\n            this.setState({ vacation });\r\n\r\n\r\n            const purchase = { ...this.state.purchase };\r\n            purchase.vacationId = vacation.vacationId;\r\n            purchase.userName = JSON.parse(sessionStorage.getItem(\"user\")).userName;\r\n            purchase.priceForTicket = vacation.price;\r\n            this.setState({ purchase });\r\n\r\n        }\r\n\r\n        catch (err) {\r\n            // if (err.response.data === \"Your login session has expired\") {\r\n            //     sessionStorage.clear();\r\n            //     alert(err.response.data);\r\n            //     this.props.history.push(\"/login\");\r\n            //     return;\r\n            // }\r\n\r\n            // else {\r\n            //     alert(err);\r\n            // }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    //disconnect from the server and the store\r\n    public componentWillUnmount(): void {\r\n        this.unsubscribeStore();\r\n    }\r\n\r\n\r\n    private setAmountOfTickets = (args: ChangeEvent<HTMLInputElement>) => {\r\n\r\n        const purchase = { ...this.state.purchase };\r\n        purchase.tickets = +args.target.value;\r\n        purchase.totalPrice = purchase.tickets * this.state.vacation.price;\r\n\r\n        this.setState({ purchase });\r\n\r\n    }\r\n\r\n    private isFormLegal() {\r\n        if (this.state.purchase.totalPrice <= 0) {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n\r\n    private send = async () => {\r\n        try {\r\n            const dateNow = new Date();\r\n            let purchase = { ...this.state.purchase };\r\n            purchase.date = dateNow;\r\n\r\n            const response = await axios.post<PurchaseModel>(Config.serverUrl + \"/api/purchases\",\r\n                purchase);\r\n            purchase = response.data;\r\n            this.props.history.push(\"/\");\r\n\r\n        }\r\n        catch (err) {\r\n            console.log(err);\r\n        }\r\n\r\n    }\r\n\r\n\r\n    public render() {\r\n        return (\r\n            <div className=\"purchaseVacation\">\r\n                <NavBar />\r\n                <div className=\"card-container\">\r\n                    <Card className=\"card-purchase\">\r\n                        <Card.Header >\r\n                            <div className=\"header\">\r\n                                <img className=\"img\" src={\"/assets/images/vacations/\" + this.state.vacation.img} />\r\n                                <span className=\"destination\">{this.state.vacation.destination || \"\"}</span>\r\n                            </div>\r\n                        </Card.Header>\r\n                        <Card.Body>\r\n                            <Card.Title>Description:</Card.Title>\r\n                            <Card.Text>\r\n                                {this.state.vacation.description || \"\"}\r\n                            </Card.Text>\r\n                            <Card.Title>Vacation Date:</Card.Title>\r\n                            <Card.Text>\r\n                                From {new Date(this.state.vacation.startingDate).toDateString()} to  {new Date(this.state.vacation.endingDate).toDateString()}\r\n                            </Card.Text>\r\n                            <Card.Title>One ticket cost:</Card.Title>\r\n                            <Card.Text>\r\n                                {this.state.vacation.price || \"\"}$\r\n                            </Card.Text>\r\n                        </Card.Body>\r\n                        <Card.Header >\r\n                            <h2>Purchase</h2>\r\n                        </Card.Header>\r\n                        <Card.Body>\r\n                            <Card.Text>\r\n                                Number Of tickets: <input type=\"text\" pattern=\"[0-9]*\" onInput={this.setAmountOfTickets.bind(this)} value={this.state.purchase.tickets} />\r\n                                {/* <input type=\"number\" value={this.state.numberOfTickets || \"\"} onChange={this.setAmountOfTickets} ></input> */}\r\n                            </Card.Text>\r\n                            <Card.Text>\r\n                                Total price: {this.state.purchase.totalPrice || \"\"}$\r\n                            </Card.Text>\r\n                            <Card.Text>\r\n                                <Button variant=\"primary\" type=\"submit\" disabled={!this.isFormLegal()} onClick={this.send} >\r\n                                    Buy\r\n                                </Button >\r\n                            </Card.Text>\r\n                        </Card.Body>\r\n\r\n                    </Card>\r\n                </div>\r\n\r\n\r\n            </div>\r\n        );\r\n    }\r\n}","import React, { Component, ChangeEvent } from \"react\";\r\nimport \"./purchases.css\";\r\nimport { PurchaseModel } from \"../../models/purchase-model\";\r\n\r\nimport axios from \"axios\";\r\n\r\nimport { Unsubscribe } from \"redux\";\r\nimport { store } from \"../../redux/store\";\r\nimport { ActionType } from \"../../redux/action-type\";\r\n\r\nimport { NavBar } from \"../nav-bar/navBar\";\r\nimport { JsonToString } from \"../../services/date\";\r\nimport { StringToJson } from \"../../services/date\";\r\nimport Card from 'react-bootstrap/Card';\r\n\r\nimport Button from 'react-bootstrap/Button';\r\nimport Form from 'react-bootstrap/Form';\r\nimport Table from 'react-bootstrap/Table';\r\n\r\n\r\nimport { Config } from \"../../config\";\r\nimport { VacationModel } from \"../../models/vacation-model\";\r\n\r\ninterface PurchaseState {\r\n    purchases: PurchaseModel[];\r\n    vacations: VacationModel[];\r\n    // numberOfTickets: number;\r\n    // totalPrice: number;\r\n}\r\n\r\nexport class Purchases extends Component<any, PurchaseState>{\r\n\r\n    private unsubscribeStore: Unsubscribe;\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n\r\n        let numberOfTickets = 0;\r\n        let totalPrice = 0;\r\n\r\n        //get vacations from the store\r\n        this.state = {\r\n            purchases: [],\r\n            vacations: []\r\n            // numberOfTickets: 0,\r\n            // totalPrice: 0,\r\n        };\r\n\r\n    }\r\n\r\n\r\n\r\n    public async componentDidMount() {\r\n\r\n\r\n        //if is there any changes in the store get the vacations from the new store.\r\n        this.unsubscribeStore = store.subscribe(() => {\r\n            // const purchases = store.getState().purchases;\r\n            const vacations = store.getState().vacations;\r\n            this.setState({ vacations });\r\n            // this.setState({ purchases });\r\n        });\r\n\r\n        let vacations = store.getState().vacations;\r\n        let purchases;\r\n\r\n        //if there is no token, link to the login page\r\n        // if (!sessionStorage.getItem(\"token\") || !sessionStorage.getItem(\"user\")) {\r\n        //     this.props.history.push(\"/login\");\r\n        //     return;\r\n        // }\r\n\r\n        //if user is not admin, link to the Home page\r\n        // else if (!JSON.parse(sessionStorage.getItem(\"user\")).isAdmin) {\r\n        //     this.props.history.push(\"/\");\r\n        // }\r\n\r\n\r\n        try {\r\n\r\n            //if the store is not empty, find the vacation for edit and don't use axios at all\r\n            if (this.state.purchases.length === 0) {\r\n                const response = await\r\n                    axios.get<PurchaseModel[]>(`${Config.serverUrl}/api/purchases`);\r\n                purchases = response.data;\r\n            }\r\n            if (this.state.vacations.length === 0) {\r\n                const response = await\r\n                    axios.get<VacationModel[]>(`${Config.serverUrl}/api/vacations`);\r\n                vacations = response.data;\r\n            }\r\n\r\n        }\r\n\r\n        catch (err) {\r\n            console.log(err);\r\n            // if (err.response.data === \"Your login session has expired\") {\r\n            //     sessionStorage.clear();\r\n            //     alert(err.response.data);\r\n            //     this.props.history.push(\"/login\");\r\n            //     return;\r\n            // }\r\n\r\n            // else {\r\n            //     alert(err);\r\n            // }\r\n\r\n        }\r\n        //     const errors = { ...this.state.errors };\r\n        this.setState({ vacations });\r\n\r\n        purchases.forEach(p => {\r\n            p.vacation = vacations.find(v => v.vacationId == p.vacationId);\r\n        });\r\n        this.setState({ purchases });\r\n\r\n    }\r\n\r\n    //disconnect from the server and the store\r\n    public componentWillUnmount(): void {\r\n        this.unsubscribeStore();\r\n    }\r\n\r\n\r\n\r\n    public render() {\r\n        return (\r\n            <div className=\"purchases\">\r\n                <NavBar />\r\n\r\n                <div className=\"table-container\">\r\n                    <h1>Purchases</h1>\r\n                    <br />\r\n                    <Table striped bordered hover>\r\n                        <thead>\r\n                            <tr>\r\n                                <th>User Name</th>\r\n                                <th>Number of Tickets</th>\r\n                                <th>Total price</th>\r\n                                <th>Vacation</th>\r\n                                <th>Date</th>\r\n                            </tr>\r\n                        </thead>\r\n                        {this.state.purchases.map(p =>\r\n                            <tbody>\r\n                                <tr>\r\n                                    <td>{p.userName}</td>\r\n                                    <td>{p.tickets}</td>\r\n                                    <td>{p.totalPrice}</td>\r\n                                    <td>{p.vacation.destination}</td>\r\n                                    <td>{new Date(p.date).toDateString()}</td>\r\n\r\n                                </tr>\r\n                            </tbody>\r\n                        )}\r\n\r\n                    </Table>\r\n\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}","import React, { Component } from \"react\";\r\nimport \"./app.css\";\r\nimport { BrowserRouter, Switch, Route } from \"react-router-dom\";\r\nimport { Home } from \"../home/home\"\r\nimport { Registration } from \"../registration/registration\";\r\nimport { Login } from \"../login/login\";\r\nimport axios from \"axios\";\r\nimport { Admin } from \"../admin/admin\";\r\nimport { EditVacation } from \"../edit-vacation/editVacation\";\r\nimport { AddVacation } from \"../add-vacation/addVacation\";\r\nimport { Reports } from \"../reports/reports\";\r\nimport { Purchase } from \"../purchase/purchase\";\r\nimport { Purchases } from \"../purchases/purchases\";\r\n\r\n\r\nexport class App extends Component<any>{\r\n\r\n    public constructor(props: any) {\r\n        super(props);\r\n        axios.interceptors.request.use(req => {\r\n            req.headers.authorization = 'Bearer '+sessionStorage.getItem(\"token\");\r\n            return req;\r\n        });\r\n\r\n        axios.interceptors.response.use(res => {\r\n            return res;\r\n          });\r\n    }\r\n\r\n    public render() {\r\n        return (\r\n            <div className=\"layout\">\r\n                <BrowserRouter>\r\n                    <Switch>\r\n                        <Route\r\n                            exact\r\n                            path={\"/\"}\r\n                            render={props => (\r\n                                <Home\r\n                                    {...props} key={\"layout\"}\r\n                                />\r\n                            )}\r\n                        />\r\n                        <Route\r\n                            exact\r\n                            path={\"/login\"} key={\"login\"}\r\n                            render={props => (\r\n                                <Login\r\n                                    {...props}\r\n                                />\r\n                            )}\r\n                        />\r\n                        <Route\r\n                            exact\r\n                            path={\"/registration\"} key={\"registration\"}\r\n                            render={props => (\r\n                                <Registration\r\n                                    {...props}\r\n                                />\r\n                            )}\r\n                        />\r\n                        <Route\r\n                            exact\r\n                            path={\"/purchase/:id\"} key={\"purchase\"}\r\n                            render={props => (\r\n                                <Purchase\r\n                                    {...props}\r\n                                />\r\n                            )}\r\n                        />\r\n                        <Route\r\n                            exact\r\n                            path={\"/purchases\"} key={\"purchases\"}\r\n                            render={props => (\r\n                                <Purchases\r\n                                    {...props}\r\n                                />\r\n                            )}\r\n                        />\r\n                        <Route\r\n                            exact\r\n                            path={\"/admin\"} key={\"registration\"}\r\n                            render={props => (\r\n                                <Admin\r\n                                    {...props}\r\n                                />\r\n                            )}\r\n                        />\r\n                        <Route\r\n                            exact\r\n                            path={\"/admin/add\"} key={\"add\"}\r\n                            render={props => (\r\n                                <AddVacation\r\n                                    {...props}\r\n                                />\r\n                            )}\r\n                        />\r\n                        <Route\r\n                            exact\r\n                            path={\"/admin/:id\"} key={\"edit\"}\r\n                            render={props => (\r\n                                <EditVacation\r\n                                    {...props}\r\n                                />\r\n                            )}\r\n                        />\r\n                        <Route\r\n                            exact\r\n                            path={\"/reports\"} key={\"reports\"}\r\n                            render={props => (\r\n                                <Reports\r\n                                    {...props}\r\n                                />\r\n                            )}\r\n                        />\r\n                    </Switch>\r\n                </BrowserRouter>\r\n            </div>\r\n        );\r\n    }\r\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './index.css';\nimport * as serviceWorker from './serviceWorker';\nimport { App } from './components/app/app';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}